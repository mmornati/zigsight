{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"ZigSight \u00b6 Welcome to ZigSight , a Home Assistant custom component that provides diagnostics and optimization tools for Zigbee networks. What is ZigSight? \u00b6 ZigSight helps you monitor, analyze, and optimize your Zigbee network by providing: Device Health Monitoring : Track battery levels, connectivity, and link quality for all your Zigbee devices Analytics Engine : Compute metrics like reconnect rates, battery trends, and health scores Wi-Fi Interference Analysis : Get recommendations for the optimal Zigbee channel based on your Wi-Fi environment Network Topology Visualization : See your entire Zigbee network in an interactive dashboard card Automation Blueprints : Pre-built automations for common monitoring scenarios Features \u00b6 Device Analytics \u00b6 ZigSight tracks key metrics for each device in your network: Reconnect Rate : How often devices disconnect and reconnect Battery Trend : Rate of battery drain over time Health Score : An aggregated health metric (0-100) combining multiple factors Connectivity Warnings : Alerts when devices have connectivity issues Battery Drain Warnings : Alerts when battery drain exceeds normal rates Wi-Fi Channel Recommendation \u00b6 Zigbee and Wi-Fi both operate in the 2.4 GHz spectrum, which can cause interference. ZigSight can analyze your Wi-Fi environment and recommend the best Zigbee channel (11, 15, 20, or 25) to minimize interference. Network Topology Card \u00b6 A custom Lovelace card displays your Zigbee network with: Device type indicators (coordinator, router, end device) Link quality visualization Health status indicators Interactive device details Automation Blueprints \u00b6 Ready-to-use automation blueprints for: Battery Drain Alerts : Notify when device batteries are low Reconnect Flap Alerts : Detect devices with frequent disconnections Daily Network Health Reports : Get a daily summary of your network status Supported Integrations \u00b6 ZigSight works with these Zigbee coordination solutions: Zigbee2MQTT - MQTT-based Zigbee bridge ZHA - Zigbee Home Automation (native Home Assistant) deCONZ - Coming soon (Dresden Elektronik's Phoscon gateway) Quick Start \u00b6 Install ZigSight - Copy the integration to your custom_components/ folder Configure - Add the integration via Settings > Devices & Services Monitor - View device health metrics and network topology Optimize - Use Wi-Fi analysis to find the best Zigbee channel Automate - Import blueprints for automatic monitoring For detailed installation instructions, see the Getting Started guide. Documentation \u00b6 Section Description Getting Started Installation and initial setup Integrations Setting up Zigbee2MQTT or ZHA Analytics Understanding device metrics and health scores Wi-Fi Recommendation Channel optimization for minimal interference UI Network topology visualization card Automations Using the automation blueprints FAQ Frequently asked questions Support \u00b6 GitHub Issues : Report bugs or request features Discussions : Ask questions and share ideas License \u00b6 ZigSight is licensed under the Apache 2.0 License. See the LICENSE file for details.","title":"Home"},{"location":"#zigsight","text":"Welcome to ZigSight , a Home Assistant custom component that provides diagnostics and optimization tools for Zigbee networks.","title":"ZigSight"},{"location":"#what-is-zigsight","text":"ZigSight helps you monitor, analyze, and optimize your Zigbee network by providing: Device Health Monitoring : Track battery levels, connectivity, and link quality for all your Zigbee devices Analytics Engine : Compute metrics like reconnect rates, battery trends, and health scores Wi-Fi Interference Analysis : Get recommendations for the optimal Zigbee channel based on your Wi-Fi environment Network Topology Visualization : See your entire Zigbee network in an interactive dashboard card Automation Blueprints : Pre-built automations for common monitoring scenarios","title":"What is ZigSight?"},{"location":"#features","text":"","title":"Features"},{"location":"#device-analytics","text":"ZigSight tracks key metrics for each device in your network: Reconnect Rate : How often devices disconnect and reconnect Battery Trend : Rate of battery drain over time Health Score : An aggregated health metric (0-100) combining multiple factors Connectivity Warnings : Alerts when devices have connectivity issues Battery Drain Warnings : Alerts when battery drain exceeds normal rates","title":"Device Analytics"},{"location":"#wi-fi-channel-recommendation","text":"Zigbee and Wi-Fi both operate in the 2.4 GHz spectrum, which can cause interference. ZigSight can analyze your Wi-Fi environment and recommend the best Zigbee channel (11, 15, 20, or 25) to minimize interference.","title":"Wi-Fi Channel Recommendation"},{"location":"#network-topology-card","text":"A custom Lovelace card displays your Zigbee network with: Device type indicators (coordinator, router, end device) Link quality visualization Health status indicators Interactive device details","title":"Network Topology Card"},{"location":"#automation-blueprints","text":"Ready-to-use automation blueprints for: Battery Drain Alerts : Notify when device batteries are low Reconnect Flap Alerts : Detect devices with frequent disconnections Daily Network Health Reports : Get a daily summary of your network status","title":"Automation Blueprints"},{"location":"#supported-integrations","text":"ZigSight works with these Zigbee coordination solutions: Zigbee2MQTT - MQTT-based Zigbee bridge ZHA - Zigbee Home Automation (native Home Assistant) deCONZ - Coming soon (Dresden Elektronik's Phoscon gateway)","title":"Supported Integrations"},{"location":"#quick-start","text":"Install ZigSight - Copy the integration to your custom_components/ folder Configure - Add the integration via Settings > Devices & Services Monitor - View device health metrics and network topology Optimize - Use Wi-Fi analysis to find the best Zigbee channel Automate - Import blueprints for automatic monitoring For detailed installation instructions, see the Getting Started guide.","title":"Quick Start"},{"location":"#documentation","text":"Section Description Getting Started Installation and initial setup Integrations Setting up Zigbee2MQTT or ZHA Analytics Understanding device metrics and health scores Wi-Fi Recommendation Channel optimization for minimal interference UI Network topology visualization card Automations Using the automation blueprints FAQ Frequently asked questions","title":"Documentation"},{"location":"#support","text":"GitHub Issues : Report bugs or request features Discussions : Ask questions and share ideas","title":"Support"},{"location":"#license","text":"ZigSight is licensed under the Apache 2.0 License. See the LICENSE file for details.","title":"License"},{"location":"DEVELOPER_README/","text":"Developer README \u00b6 This document provides information for developers contributing to the ZigSight project. Repository Layout \u00b6 . \u251c\u2500\u2500 .github/ \u2502 \u2514\u2500\u2500 workflows/ \u2502 \u2514\u2500\u2500 ci.yml # GitHub Actions CI workflow \u251c\u2500\u2500 automations/ \u2502 \u251c\u2500\u2500 README.md # Blueprint overview and import instructions \u2502 \u251c\u2500\u2500 battery_drain.yaml # Battery low alert blueprint \u2502 \u251c\u2500\u2500 reconnect_flap.yaml # Device flapping alert blueprint \u2502 \u2514\u2500\u2500 network_health_daily_report.yaml # Daily health report blueprint \u251c\u2500\u2500 custom_components/ \u2502 \u2514\u2500\u2500 zigsight/ \u2502 \u251c\u2500\u2500 __init__.py # Integration entry point \u2502 \u251c\u2500\u2500 manifest.json # Home Assistant manifest \u2502 \u251c\u2500\u2500 config_flow.py # Configuration flow handler \u2502 \u251c\u2500\u2500 options_flow.py # Options flow handler \u2502 \u251c\u2500\u2500 coordinator.py # Data update coordinator \u2502 \u251c\u2500\u2500 analytics.py # Analytics engine for metrics computation \u2502 \u251c\u2500\u2500 const.py # Constants \u2502 \u251c\u2500\u2500 services.yaml # Service definitions \u2502 \u251c\u2500\u2500 sensor/ \u2502 \u2502 \u251c\u2500\u2500 __init__.py # Sensor platform setup \u2502 \u2502 \u2514\u2500\u2500 sensor.py # Sensor entity classes \u2502 \u2514\u2500\u2500 binary_sensor/ \u2502 \u251c\u2500\u2500 __init__.py # Binary sensor platform setup \u2502 \u2514\u2500\u2500 binary_sensor.py # Binary sensor entity classes \u251c\u2500\u2500 docs/ \u2502 \u251c\u2500\u2500 getting_started.md # User documentation \u2502 \u251c\u2500\u2500 automations.md # Automation blueprints guide \u2502 \u2514\u2500\u2500 DEVELOPER_README.md # This file \u251c\u2500\u2500 tests/ \u2502 \u251c\u2500\u2500 test_manifest.py # Manifest validation tests \u2502 \u251c\u2500\u2500 test_coordinator.py # Coordinator tests \u2502 \u2514\u2500\u2500 test_sensor.py # Sensor entity tests \u251c\u2500\u2500 pyproject.toml # Project configuration \u251c\u2500\u2500 requirements-dev.txt # Development dependencies \u2514\u2500\u2500 README.md # Project README Development Environment \u00b6 Python : 3.11 \u2013 3.13 (CI defaults to 3.13) Home Assistant compatibility : homeassistant>=2025.10.0 Quick Start \u00b6 git clone https://github.com/mmornati/zigsight.git cd zigsight make setup-dev source .venv/bin/activate make setup-dev creates the local virtualenv, installs every developer dependency from requirements-dev.txt , and registers the pre-commit hooks so linting runs before commits. Handy Make targets \u00b6 Command What it does make lint ruff check . + mypy (mirrors the GitHub CI lint job) make security Runs Bandit with the project configuration make test Unit tests with coverage HTML + terminal summary make test-quick Unit tests without coverage make format ruff format . plus ruff check --fix . make check-format Verify formatting ( ruff format --check . , ruff check . ) make clean Remove cached artifacts ( .mypy_cache , .ruff_cache , .pytest_cache , \u2026) All commands assume the virtualenv created by make setup-dev is active. Manual setup (optional) \u00b6 If you prefer not to use the Makefile helpers: python3 -m venv .venv source .venv/bin/activate pip install --upgrade pip pip install -r requirements-dev.txt pre-commit install Run the individual tools exactly as the make targets do: ruff check . ruff format --check . mypy custom_components/zigsight/ pytest tests/ bandit -r custom_components/zigsight -c tests/bandit.yaml Coverage \u00b6 Project target coverage is 85% . pytest --cov=custom_components --cov-report=html tests/ open htmlcov/index.html The CI pipeline uploads coverage to Codecov; results without a token are still published for public repositories. Adding Secrets for Codecov \u00b6 Codecov token is optional for public repositories. If you want to add a Codecov token: Go to Codecov and sign in with GitHub Add your repository Copy the repository upload token In your GitHub repository, go to Settings > Secrets and variables > Actions Add a new secret named CODECOV_TOKEN with the token value The CI workflow will automatically use this token if present. Project Structure Guidelines \u00b6 Constants : All constants should be defined in const.py Coordinator : Data fetching and state management in coordinator.py Analytics : Metrics computation engine in analytics.py Entities : Sensor entities in sensor/sensor.py , binary sensors in binary_sensor/binary_sensor.py Platform Setup : Platform initialization in sensor/__init__.py and binary_sensor/__init__.py Config Flow : User configuration in config_flow.py Options : Configuration options in options_flow.py Analytics Algorithms \u00b6 The analytics engine ( analytics.py ) provides metrics computation for device health monitoring. Function Signatures \u00b6 DeviceAnalytics.__init__() \u00b6 def __init__( reconnect_rate_window_hours: int = 24, battery_drain_threshold: float = 10.0, min_battery_for_trend: int = 20, ) -> None Initializes the analytics engine with configurable thresholds. Parameters : - reconnect_rate_window_hours : Time window in hours for reconnect rate calculation (default: 24) - battery_drain_threshold : Minimum drain rate (%/hour) to trigger warning (default: 10.0) - min_battery_for_trend : Minimum battery % to compute trend (default: 20) compute_reconnect_rate() \u00b6 def compute_reconnect_rate( device_history: list[dict[str, Any]], window_hours: int | None = None, ) -> float Algorithm : 1. Filter history entries within time window 2. Sort entries by timestamp 3. Detect gaps > 5 minutes between consecutive entries (reconnection events) 4. Count reconnection events within window 5. Calculate rate as events/hour Returns : Reconnect rate (events/hour) or 0.0 if insufficient data Time Complexity : O(n log n) where n = number of history entries (due to sorting) compute_battery_trend() \u00b6 def compute_battery_trend( device_history: list[dict[str, Any]], window_hours: int = 24, ) -> float | None Algorithm : 1. Extract battery readings from history within time window 2. Filter readings with battery \u2265 min_battery_for_trend (20% default) 3. Sort by timestamp 4. Compute linear regression slope using least squares method 5. Return percentage change per hour (negative = draining) Returns : Battery trend (%/hour) or None if insufficient data Time Complexity : O(n) where n = number of history entries Linear Regression Formula : slope = (n \u00d7 \u03a3(t\u00d7b) - \u03a3(t) \u00d7 \u03a3(b)) / (n \u00d7 \u03a3(t\u00b2) - (\u03a3(t))\u00b2) where: - n = number of data points - t = time in hours since first reading - b = battery percentage compute_health_score() \u00b6 def compute_health_score( device_data: dict[str, Any], device_history: list[dict[str, Any]], ) -> float Algorithm : 1. Extract current metrics: link_quality, battery, last_seen 2. Normalize each component to 0-100 scale: - Link Quality : Normalize 0-255 \u2192 0-100 (higher is better) - Battery : Use as-is 0-100% (higher is better) - Reconnect Rate : Invert (0/hour = 100, 10+/hour = 0) - Connectivity : Based on last_seen recency (< 5 min = 100, > 1 hour = 0, linear decay) 3. Apply weighted average using configured weights (default: link_quality 30%, battery 20%, reconnect_rate 30%, connectivity 20%) 4. Return score 0-100 where 100 is excellent Returns : Health score (0-100) where 100 is excellent Time Complexity : O(1) for score calculation, O(n) for reconnect rate computation Score Interpretation : - 90-100: Excellent - 70-89: Good - 50-69: Fair - 0-49: Poor check_battery_drain_warning() \u00b6 def check_battery_drain_warning( device_history: list[dict[str, Any]], threshold: float | None = None, ) -> bool Algorithm : 1. Compute battery trend using compute_battery_trend() 2. Compare trend against threshold (default: 10%/hour) 3. Return True if trend < -threshold (negative = draining) Returns : True if battery drain warning should be triggered check_connectivity_warning() \u00b6 def check_connectivity_warning( device_data: dict[str, Any], reconnect_rate_threshold: float = 5.0, ) -> bool Algorithm : 1. Extract device history from device_data 2. Compute reconnect rate using compute_reconnect_rate() 3. Check if reconnect_rate \u2265 threshold 4. OR check if last_seen > 1 hour ago 5. Return True if either condition is met Returns : True if connectivity warning should be triggered Data Retention Policy \u00b6 Maximum History : 1000 entries per device (last entries kept, FIFO) Retention Period : Configurable via retention_days (default: 30 days) Memory Usage : Approximately 10-50 KB per device depending on history size History is stored in-memory in the coordinator. For persistent storage, use Home Assistant's built-in history features. Performance Considerations \u00b6 Reconnect Rate Calculation : O(n log n) due to sorting. Consider caching if called frequently. Battery Trend Calculation : O(n). Optimized by filtering entries outside window early. Health Score Calculation : O(1) after component extraction. Reconnect rate computation may be O(n log n). Memory Usage : Linear with number of devices and history size. Monitor memory usage in production. Testing Analytics Functions \u00b6 See tests/test_analytics.py for comprehensive test coverage: Test reconnect rate with various history patterns Test battery trend with different drain scenarios Test health score computation with different metrics Test warning conditions with threshold variations Wi-Fi Scanner Adapters \u00b6 ZigSight includes a Wi-Fi scanning system for channel recommendation. The system uses an adapter pattern to support multiple input methods. Scanner Architecture \u00b6 All scanners implement the WiFiScanner abstract base class: class WiFiScanner(ABC): @abstractmethod async def scan(self) -> list[dict[str, Any]]: \"\"\"Return list of APs with keys: channel, rssi, ssid (optional)\"\"\" Available Adapters \u00b6 ManualScanner \u00b6 Accepts pre-scanned data from user input. Usage: scanner = ManualScanner(scan_data=[ {\"channel\": 1, \"rssi\": -45, \"ssid\": \"Network1\"}, {\"channel\": 6, \"rssi\": -60} ]) aps = await scanner.scan() RouterAPIScanner \u00b6 Queries router APIs for scan data. Currently a placeholder for future router-specific implementations. Supported Router Types: - UniFi (planned) - OpenWrt (planned) - Fritz!Box (planned) Adding Router Support: Extend RouterAPIScanner.scan() to add router-specific API calls: async def scan(self) -> list[dict[str, Any]]: if self.router_type == \"unifi\": return await self._scan_unifi() elif self.router_type == \"openwrt\": return await self._scan_openwrt() # ... HostScanner \u00b6 Scans Wi-Fi using host system tools (iwlist or nmcli). Requirements: - Linux host with Wi-Fi adapter - iwlist (wireless-tools) or nmcli (NetworkManager) installed - Appropriate permissions (may require privileged add-on) Permissions: - iwlist : Typically requires root or CAP_NET_ADMIN capability - nmcli : Usually works without elevated permissions if NetworkManager is running Factory Function \u00b6 Use create_scanner() to instantiate the appropriate scanner: from custom_components.zigsight.wifi_scanner import create_scanner # Manual mode scanner = create_scanner( mode=\"manual\", scan_data=[{\"channel\": 1, \"rssi\": -45}] ) # Router API mode scanner = create_scanner( mode=\"router_api\", router_config={ \"router_type\": \"unifi\", \"host\": \"192.168.1.1\", \"username\": \"admin\", \"password\": \"secret\" } ) # Host scan mode scanner = create_scanner( mode=\"host_scan\", host_config={\"interface\": \"wlan0\"} ) Adding a New Router Adapter \u00b6 Identify the API endpoint for Wi-Fi scanning in your router Add authentication logic in RouterAPIScanner.__init__() Implement the scan method for your router type: async def _scan_your_router(self) -> list[dict[str, Any]]: \"\"\"Scan using YourRouter API.\"\"\" async with aiohttp.ClientSession() as session: # Authenticate auth_data = await self._authenticate_your_router(session) # Query scan endpoint async with session.get( f\"http://{self.host}/api/wifi/scan\", headers={\"Authorization\": f\"Bearer {auth_data['token']}\"} ) as response: data = await response.json() # Parse response into standard format return [ { \"channel\": ap[\"chan\"], \"rssi\": ap[\"signal\"], \"ssid\": ap.get(\"name\") } for ap in data[\"access_points\"] ] Add router type to RouterAPIScanner.scan() dispatch logic Add tests in tests/test_wifi_scanner.py Document in docs/wifi_recommendation.md Testing Scanner Adapters \u00b6 See tests/test_wifi_scanner.py for comprehensive test coverage: @pytest.mark.asyncio async def test_your_scanner() -> None: scanner = YourScanner(config) result = await scanner.scan() assert isinstance(result, list) for ap in result: assert \"channel\" in ap assert \"rssi\" in ap Channel Recommender Algorithm \u00b6 The channel recommender in recommender.py uses frequency overlap analysis to score Zigbee channels. Algorithm Overview \u00b6 Calculate Overlap Factor for each Wi-Fi AP and Zigbee channel pair: Compute frequency distance between channels Apply overlap percentage based on bandwidth (Wi-Fi ~22 MHz, Zigbee ~2 MHz) Factor in signal strength (RSSI) Score Each Zigbee Channel (11, 15, 20, 25): Sum overlap factors from all Wi-Fi APs Lower score = less interference Select Best Channel : Choose channel with lowest score Generate human-readable explanation Key Functions \u00b6 calculate_overlap_factor(wifi_channel, zigbee_channel, rssi) \u00b6 Returns interference factor (0-100) for a single Wi-Fi AP and Zigbee channel pair. Formula: freq_distance = abs(wifi_freq - zigbee_freq) overlap_percentage = max(0, 1 - (freq_distance / 22)) normalized_rssi = (rssi + 90) * 100 / 60 # -30 to -90 dBm range interference_factor = overlap_percentage * normalized_rssi score_zigbee_channel(zigbee_channel, wifi_aps) \u00b6 Returns total interference score (0-100) for a Zigbee channel considering all Wi-Fi APs. recommend_zigbee_channel(wifi_aps) \u00b6 Returns dict with recommended_channel , scores , and explanation . Frequency Mappings \u00b6 Wi-Fi (2.4 GHz): - Channel 1: 2412 MHz - Channel 6: 2437 MHz (most common) - Channel 11: 2462 MHz - Channels 1-13 supported (14 in Japan) Zigbee (2.4 GHz): - Channel 11: 2405 MHz (recommended) - Channel 15: 2425 MHz (recommended) - Channel 20: 2450 MHz (recommended) - Channel 25: 2475 MHz (recommended) - Channels 12-24, 26 available but not recommended Frontend Development \u00b6 ZigSight includes a custom Lovelace card for network topology visualization. Card Location \u00b6 The topology card is located at: custom_components/zigsight/www/topology-card.js No Build Process Required \u00b6 The topology card is written in vanilla JavaScript and requires no build process. It can be directly loaded by Home Assistant as a Lovelace resource. Card Registration \u00b6 The card is automatically registered when loaded. Users need to: Copy the card to their www/ directory: bash mkdir -p config/www/community/zigsight cp custom_components/zigsight/www/topology-card.js config/www/community/zigsight/ Register as a Lovelace resource in configuration.yaml : ```yaml lovelace: mode: yaml resources: url: /local/community/zigsight/topology-card.js type: module ``` Or via UI: Settings \u2192 Dashboards \u2192 Resources \u2192 Add Resource Card Usage \u00b6 Add to any dashboard: type: custom:zigsight-topology-card title: Zigbee Network Topology Card Development \u00b6 To modify the card: Edit custom_components/zigsight/www/topology-card.js Copy updated file to Home Assistant's www/ directory Clear browser cache or use incognito mode Refresh the dashboard Card Features \u00b6 Network Statistics : Shows device counts by type Device Cards : Interactive cards for each device with metrics Color Coding : Visual indicators for device type and health Device Details : Click any device to see detailed information Link Quality : Color-coded signal strength indicators Warnings : Highlights devices with connectivity or battery issues API Endpoint \u00b6 The card fetches data from /api/zigsight/topology which returns: - Node list with device information - Edge list with parent-child relationships - Network statistics See docs/ui.md for complete API documentation. Testing Frontend Changes \u00b6 Since there's no build process, testing is straightforward: Copy the updated card to Home Assistant Reload the dashboard Check browser console for errors Test all interactive features Future Enhancements \u00b6 Potential improvements for the topology card: Interactive graph visualization (D3.js, vis-network) Device filtering and search Automatic refresh intervals Export topology as image Historical topology comparison Custom color schemes Automation Blueprints \u00b6 ZigSight includes pre-built Home Assistant automation blueprints in the automations/ directory. Blueprint Location \u00b6 Blueprints are stored in: automations/ \u251c\u2500\u2500 README.md # Overview and import instructions \u251c\u2500\u2500 battery_drain.yaml # Battery low alert blueprint \u251c\u2500\u2500 reconnect_flap.yaml # Device flapping detection blueprint \u2514\u2500\u2500 network_health_daily_report.yaml # Daily network health report blueprint Blueprint Structure \u00b6 Each blueprint follows the Home Assistant blueprint schema: blueprint: name: Blueprint Name description: Description of what the blueprint does domain: automation author: ZigSight source_url: https://github.com/mmornati/zigsight/blob/main/automations/blueprint.yaml input: input_name: name: Human Readable Name description: What this input controls default: default_value selector: # Input selector type trigger: # Trigger configuration condition: # Optional conditions action: # Actions to perform Creating a New Blueprint \u00b6 Create the blueprint file in automations/ : bash touch automations/my_new_blueprint.yaml Define the blueprint metadata : name : Short, descriptive name description : What the blueprint does domain : Always automation for automation blueprints author : \"ZigSight\" source_url : Link to the file on GitHub Define inputs with appropriate selectors: entity : Entity picker number : Numeric input with min/max/step text : Free text input boolean : Toggle switch time : Time picker select : Dropdown selection Add triggers, conditions, and actions using the inputs: ```yaml trigger: platform: state entity_id: !input my_entity_input ``` Test the blueprint : Import into Home Assistant Create an automation from it Verify all inputs work correctly Add tests in tests/test_blueprints.yaml : python def test_my_blueprint_yaml_valid(): \"\"\"Test that my_blueprint.yaml is valid YAML.\"\"\" blueprint_path = Path(\"automations/my_new_blueprint.yaml\") with blueprint_path.open() as f: data = yaml.safe_load(f) assert \"blueprint\" in data assert \"trigger\" in data assert \"action\" in data Update documentation : Add to automations/README.md Add configuration reference to docs/automations.md Blueprint Testing \u00b6 Blueprint YAML files are validated in CI: # Run blueprint validation tests pytest tests/test_blueprints.py -v Tests verify: - YAML syntax is valid - Required blueprint keys are present - Input definitions are properly formatted - Triggers and actions are defined User Documentation \u00b6 User-facing documentation is in docs/automations.md , which covers: - How to import blueprints - How to create automations from blueprints - Configuration reference for each blueprint - Customization examples Documentation Site \u00b6 ZigSight documentation is built using MkDocs and automatically deployed to GitHub Pages. Viewing the Documentation \u00b6 The documentation site is available at: https://mmornati.github.io/zigsight/ Building Documentation Locally \u00b6 To preview documentation changes locally: # Install documentation dependencies pip install -r requirements-docs.txt # Start the development server mkdocs serve # Or build the static site mkdocs build The development server runs at http://127.0.0.1:8000/ with live reload. Documentation Structure \u00b6 Documentation files are in the docs/ directory: docs/ \u251c\u2500\u2500 index.md # Homepage \u251c\u2500\u2500 getting_started.md # Installation guide \u251c\u2500\u2500 analytics.md # Analytics engine documentation \u251c\u2500\u2500 wifi_recommendation.md # Wi-Fi channel recommendation guide \u251c\u2500\u2500 ui.md # Network topology card documentation \u251c\u2500\u2500 automations.md # Automation blueprints guide \u251c\u2500\u2500 faq.md # Frequently asked questions \u251c\u2500\u2500 DEVELOPER_README.md # This file \u2514\u2500\u2500 integrations/ \u251c\u2500\u2500 zigbee2mqtt.md # Zigbee2MQTT integration guide \u251c\u2500\u2500 zha.md # ZHA integration guide \u2514\u2500\u2500 deconz.md # deCONZ integration guide Adding or Editing Pages \u00b6 Create or edit markdown files in the docs/ directory Update mkdocs.yml navigation if adding new pages Test locally with mkdocs serve Submit a pull request Deployment Workflow \u00b6 Documentation is automatically deployed via the .github/workflows/deploy-docs.yaml workflow: Trigger : Push to main branch that modifies docs/** , mkdocs.yml , or requirements-docs.txt Build : MkDocs builds the static site with mkdocs build --strict Deploy : The peaceiris/actions-gh-pages action publishes to the gh-pages branch Hosting : GitHub Pages serves the site from the gh-pages branch The workflow can also be triggered manually via workflow_dispatch . MkDocs Configuration \u00b6 The documentation configuration is in mkdocs.yml : Theme : ReadTheDocs theme Plugins : Search Extensions : Tables, fenced code blocks, admonitions, table of contents Documentation Requirements \u00b6 Documentation dependencies are in requirements-docs.txt : mkdocs>=1.5.0 ZHA Integration Support \u00b6 ZigSight supports collecting device diagnostics from the Zigbee Home Automation (ZHA) integration alongside Zigbee2MQTT. Architecture \u00b6 The ZHA collector ( zha_collector.py ) implements a polling-based approach to gather device metrics: \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Coordinator \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 v v \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 MQTT \u2502 \u2502 ZHA \u2502 \u2502 Collector\u2502 \u2502 Collector \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 v v \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Device Metrics \u2502 \u2502 (Normalized Format) \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 ZHA Collector Implementation \u00b6 The ZHACollector class provides: Key Methods \u00b6 is_available() -> bool Checks if ZHA integration is loaded by testing \"zha\" in hass.data . collect_devices() -> dict[str, dict[str, Any]] Collects all ZHA devices and their metrics: 1. Access hass.data[\"zha\"][\"gateway\"] 2. Iterate through gateway.devices 3. For each device, collect metrics from: - Device attributes ( lqi , rssi , last_seen ) - Diagnostic entities ( sensor.<device>_rssi , etc.) 4. Normalize metrics to coordinator format _collect_device_metrics(zha_device) -> dict[str, Any] Extracts metrics from ZHA device attributes: - lqi \u2192 link_quality - rssi \u2192 rssi - last_seen \u2192 ISO 8601 timestamp _collect_entity_metrics(ieee: str) -> dict[str, Any] Reads diagnostic entities from device/entity registries: 1. Find device by IEEE address in device registry 2. Get entities for device from entity registry 3. Read entity states for RSSI, LQI, battery Metric Normalization \u00b6 ZHA metrics are normalized to match Zigbee2MQTT format for consistency: ZHA Source Normalized Name Type zha_device.lqi link_quality int (0-255) zha_device.rssi rssi int (dBm) zha_device.last_seen last_seen ISO 8601 string sensor.<device>_battery battery float (%) Coordinator Integration \u00b6 The coordinator integrates ZHA collection through: Configuration coordinator = ZigSightCoordinator( hass, enable_zha=True, # Enable ZHA collection ... ) Update Cycle async def _async_update_data(self) -> dict[str, Any]: # Collect ZHA devices if enabled if self._enable_zha and self._zha_collector: await self._collect_zha_devices() # ... continue with MQTT and analytics Device Processing def _process_zha_device_update(self, device_id: str, device_data: dict): # Process ZHA device similar to MQTT devices # - Track reconnections # - Store metrics # - Update history # - Fire events ZHA API Usage \u00b6 ZigSight uses the following Home Assistant APIs for ZHA: Stable APIs (Public) - device_registry.async_get(hass) - Get device registry - entity_registry.async_get(hass) - Get entity registry - device_registry.async_get_device(identifiers) - Find device by ID - entity_registry.async_entries_for_device(device_id) - Get device entities - hass.states.get(entity_id) - Read entity state Internal APIs (May Change) - hass.data[\"zha\"] - Access ZHA integration data - hass.data[\"zha\"][\"gateway\"] - Access ZHA gateway - gateway.devices - Iterate ZHA devices - zha_device.lqi , zha_device.rssi - Device attributes Handling ZHA Changes \u00b6 If ZHA internals change in future Home Assistant versions: Check ZHA integration release notes for API changes Update ZHACollector methods to match new APIs Add version checks if supporting multiple HA versions: python from homeassistant.const import __version__ if __version__ >= \"2025.1.0\": # New API else: # Legacy API Update tests to cover new behavior Document changes in docs/integrations/zha.md Testing ZHA Collector \u00b6 Tests use mocks to simulate ZHA integration: # Mock ZHA gateway mock_gateway = MagicMock() mock_gateway.devices = {ieee: mock_device} mock_hass.data[\"zha\"] = {\"gateway\": mock_gateway} # Mock device attributes mock_device.lqi = 200 mock_device.rssi = -50 mock_device.last_seen = datetime.now() # Test collection collector = ZHACollector(mock_hass) devices = await collector.collect_devices() See tests/test_zha_collector.py for comprehensive test coverage. Performance Considerations \u00b6 Polling interval : ZHA collection runs on coordinator update cycle (60s default) Device count : Tested with up to 50 devices; larger networks may need tuning Registry access : Device/entity registry lookups are cached by Home Assistant Entity state reads : Minimal overhead, reads from state machine Future Enhancements \u00b6 Potential improvements for ZHA support: Network topology : Extract parent-child relationships from ZHA Route table : Access ZHA routing information Device statistics : Collect packet loss, retry counts Event-based updates : Subscribe to ZHA device events instead of polling Deeper integration : Use ZHA's internal state tracking Contributing \u00b6 Create a feature branch: git checkout -b feature/your-feature-name Make your changes Run tests and linting locally Commit your changes: git commit -m \"Add feature: description\" Push to GitHub: git push origin feature/your-feature-name Create a Pull Request Resources \u00b6 Home Assistant Developer Documentation Home Assistant Integration Architecture Pytest Documentation Ruff Documentation Wi-Fi/Zigbee Coexistence","title":"Developer Guide"},{"location":"DEVELOPER_README/#developer-readme","text":"This document provides information for developers contributing to the ZigSight project.","title":"Developer README"},{"location":"DEVELOPER_README/#repository-layout","text":". \u251c\u2500\u2500 .github/ \u2502 \u2514\u2500\u2500 workflows/ \u2502 \u2514\u2500\u2500 ci.yml # GitHub Actions CI workflow \u251c\u2500\u2500 automations/ \u2502 \u251c\u2500\u2500 README.md # Blueprint overview and import instructions \u2502 \u251c\u2500\u2500 battery_drain.yaml # Battery low alert blueprint \u2502 \u251c\u2500\u2500 reconnect_flap.yaml # Device flapping alert blueprint \u2502 \u2514\u2500\u2500 network_health_daily_report.yaml # Daily health report blueprint \u251c\u2500\u2500 custom_components/ \u2502 \u2514\u2500\u2500 zigsight/ \u2502 \u251c\u2500\u2500 __init__.py # Integration entry point \u2502 \u251c\u2500\u2500 manifest.json # Home Assistant manifest \u2502 \u251c\u2500\u2500 config_flow.py # Configuration flow handler \u2502 \u251c\u2500\u2500 options_flow.py # Options flow handler \u2502 \u251c\u2500\u2500 coordinator.py # Data update coordinator \u2502 \u251c\u2500\u2500 analytics.py # Analytics engine for metrics computation \u2502 \u251c\u2500\u2500 const.py # Constants \u2502 \u251c\u2500\u2500 services.yaml # Service definitions \u2502 \u251c\u2500\u2500 sensor/ \u2502 \u2502 \u251c\u2500\u2500 __init__.py # Sensor platform setup \u2502 \u2502 \u2514\u2500\u2500 sensor.py # Sensor entity classes \u2502 \u2514\u2500\u2500 binary_sensor/ \u2502 \u251c\u2500\u2500 __init__.py # Binary sensor platform setup \u2502 \u2514\u2500\u2500 binary_sensor.py # Binary sensor entity classes \u251c\u2500\u2500 docs/ \u2502 \u251c\u2500\u2500 getting_started.md # User documentation \u2502 \u251c\u2500\u2500 automations.md # Automation blueprints guide \u2502 \u2514\u2500\u2500 DEVELOPER_README.md # This file \u251c\u2500\u2500 tests/ \u2502 \u251c\u2500\u2500 test_manifest.py # Manifest validation tests \u2502 \u251c\u2500\u2500 test_coordinator.py # Coordinator tests \u2502 \u2514\u2500\u2500 test_sensor.py # Sensor entity tests \u251c\u2500\u2500 pyproject.toml # Project configuration \u251c\u2500\u2500 requirements-dev.txt # Development dependencies \u2514\u2500\u2500 README.md # Project README","title":"Repository Layout"},{"location":"DEVELOPER_README/#development-environment","text":"Python : 3.11 \u2013 3.13 (CI defaults to 3.13) Home Assistant compatibility : homeassistant>=2025.10.0","title":"Development Environment"},{"location":"DEVELOPER_README/#quick-start","text":"git clone https://github.com/mmornati/zigsight.git cd zigsight make setup-dev source .venv/bin/activate make setup-dev creates the local virtualenv, installs every developer dependency from requirements-dev.txt , and registers the pre-commit hooks so linting runs before commits.","title":"Quick Start"},{"location":"DEVELOPER_README/#handy-make-targets","text":"Command What it does make lint ruff check . + mypy (mirrors the GitHub CI lint job) make security Runs Bandit with the project configuration make test Unit tests with coverage HTML + terminal summary make test-quick Unit tests without coverage make format ruff format . plus ruff check --fix . make check-format Verify formatting ( ruff format --check . , ruff check . ) make clean Remove cached artifacts ( .mypy_cache , .ruff_cache , .pytest_cache , \u2026) All commands assume the virtualenv created by make setup-dev is active.","title":"Handy Make targets"},{"location":"DEVELOPER_README/#manual-setup-optional","text":"If you prefer not to use the Makefile helpers: python3 -m venv .venv source .venv/bin/activate pip install --upgrade pip pip install -r requirements-dev.txt pre-commit install Run the individual tools exactly as the make targets do: ruff check . ruff format --check . mypy custom_components/zigsight/ pytest tests/ bandit -r custom_components/zigsight -c tests/bandit.yaml","title":"Manual setup (optional)"},{"location":"DEVELOPER_README/#coverage","text":"Project target coverage is 85% . pytest --cov=custom_components --cov-report=html tests/ open htmlcov/index.html The CI pipeline uploads coverage to Codecov; results without a token are still published for public repositories.","title":"Coverage"},{"location":"DEVELOPER_README/#adding-secrets-for-codecov","text":"Codecov token is optional for public repositories. If you want to add a Codecov token: Go to Codecov and sign in with GitHub Add your repository Copy the repository upload token In your GitHub repository, go to Settings > Secrets and variables > Actions Add a new secret named CODECOV_TOKEN with the token value The CI workflow will automatically use this token if present.","title":"Adding Secrets for Codecov"},{"location":"DEVELOPER_README/#project-structure-guidelines","text":"Constants : All constants should be defined in const.py Coordinator : Data fetching and state management in coordinator.py Analytics : Metrics computation engine in analytics.py Entities : Sensor entities in sensor/sensor.py , binary sensors in binary_sensor/binary_sensor.py Platform Setup : Platform initialization in sensor/__init__.py and binary_sensor/__init__.py Config Flow : User configuration in config_flow.py Options : Configuration options in options_flow.py","title":"Project Structure Guidelines"},{"location":"DEVELOPER_README/#analytics-algorithms","text":"The analytics engine ( analytics.py ) provides metrics computation for device health monitoring.","title":"Analytics Algorithms"},{"location":"DEVELOPER_README/#function-signatures","text":"","title":"Function Signatures"},{"location":"DEVELOPER_README/#deviceanalytics__init__","text":"def __init__( reconnect_rate_window_hours: int = 24, battery_drain_threshold: float = 10.0, min_battery_for_trend: int = 20, ) -> None Initializes the analytics engine with configurable thresholds. Parameters : - reconnect_rate_window_hours : Time window in hours for reconnect rate calculation (default: 24) - battery_drain_threshold : Minimum drain rate (%/hour) to trigger warning (default: 10.0) - min_battery_for_trend : Minimum battery % to compute trend (default: 20)","title":"DeviceAnalytics.__init__()"},{"location":"DEVELOPER_README/#compute_reconnect_rate","text":"def compute_reconnect_rate( device_history: list[dict[str, Any]], window_hours: int | None = None, ) -> float Algorithm : 1. Filter history entries within time window 2. Sort entries by timestamp 3. Detect gaps > 5 minutes between consecutive entries (reconnection events) 4. Count reconnection events within window 5. Calculate rate as events/hour Returns : Reconnect rate (events/hour) or 0.0 if insufficient data Time Complexity : O(n log n) where n = number of history entries (due to sorting)","title":"compute_reconnect_rate()"},{"location":"DEVELOPER_README/#compute_battery_trend","text":"def compute_battery_trend( device_history: list[dict[str, Any]], window_hours: int = 24, ) -> float | None Algorithm : 1. Extract battery readings from history within time window 2. Filter readings with battery \u2265 min_battery_for_trend (20% default) 3. Sort by timestamp 4. Compute linear regression slope using least squares method 5. Return percentage change per hour (negative = draining) Returns : Battery trend (%/hour) or None if insufficient data Time Complexity : O(n) where n = number of history entries Linear Regression Formula : slope = (n \u00d7 \u03a3(t\u00d7b) - \u03a3(t) \u00d7 \u03a3(b)) / (n \u00d7 \u03a3(t\u00b2) - (\u03a3(t))\u00b2) where: - n = number of data points - t = time in hours since first reading - b = battery percentage","title":"compute_battery_trend()"},{"location":"DEVELOPER_README/#compute_health_score","text":"def compute_health_score( device_data: dict[str, Any], device_history: list[dict[str, Any]], ) -> float Algorithm : 1. Extract current metrics: link_quality, battery, last_seen 2. Normalize each component to 0-100 scale: - Link Quality : Normalize 0-255 \u2192 0-100 (higher is better) - Battery : Use as-is 0-100% (higher is better) - Reconnect Rate : Invert (0/hour = 100, 10+/hour = 0) - Connectivity : Based on last_seen recency (< 5 min = 100, > 1 hour = 0, linear decay) 3. Apply weighted average using configured weights (default: link_quality 30%, battery 20%, reconnect_rate 30%, connectivity 20%) 4. Return score 0-100 where 100 is excellent Returns : Health score (0-100) where 100 is excellent Time Complexity : O(1) for score calculation, O(n) for reconnect rate computation Score Interpretation : - 90-100: Excellent - 70-89: Good - 50-69: Fair - 0-49: Poor","title":"compute_health_score()"},{"location":"DEVELOPER_README/#check_battery_drain_warning","text":"def check_battery_drain_warning( device_history: list[dict[str, Any]], threshold: float | None = None, ) -> bool Algorithm : 1. Compute battery trend using compute_battery_trend() 2. Compare trend against threshold (default: 10%/hour) 3. Return True if trend < -threshold (negative = draining) Returns : True if battery drain warning should be triggered","title":"check_battery_drain_warning()"},{"location":"DEVELOPER_README/#check_connectivity_warning","text":"def check_connectivity_warning( device_data: dict[str, Any], reconnect_rate_threshold: float = 5.0, ) -> bool Algorithm : 1. Extract device history from device_data 2. Compute reconnect rate using compute_reconnect_rate() 3. Check if reconnect_rate \u2265 threshold 4. OR check if last_seen > 1 hour ago 5. Return True if either condition is met Returns : True if connectivity warning should be triggered","title":"check_connectivity_warning()"},{"location":"DEVELOPER_README/#data-retention-policy","text":"Maximum History : 1000 entries per device (last entries kept, FIFO) Retention Period : Configurable via retention_days (default: 30 days) Memory Usage : Approximately 10-50 KB per device depending on history size History is stored in-memory in the coordinator. For persistent storage, use Home Assistant's built-in history features.","title":"Data Retention Policy"},{"location":"DEVELOPER_README/#performance-considerations","text":"Reconnect Rate Calculation : O(n log n) due to sorting. Consider caching if called frequently. Battery Trend Calculation : O(n). Optimized by filtering entries outside window early. Health Score Calculation : O(1) after component extraction. Reconnect rate computation may be O(n log n). Memory Usage : Linear with number of devices and history size. Monitor memory usage in production.","title":"Performance Considerations"},{"location":"DEVELOPER_README/#testing-analytics-functions","text":"See tests/test_analytics.py for comprehensive test coverage: Test reconnect rate with various history patterns Test battery trend with different drain scenarios Test health score computation with different metrics Test warning conditions with threshold variations","title":"Testing Analytics Functions"},{"location":"DEVELOPER_README/#wi-fi-scanner-adapters","text":"ZigSight includes a Wi-Fi scanning system for channel recommendation. The system uses an adapter pattern to support multiple input methods.","title":"Wi-Fi Scanner Adapters"},{"location":"DEVELOPER_README/#scanner-architecture","text":"All scanners implement the WiFiScanner abstract base class: class WiFiScanner(ABC): @abstractmethod async def scan(self) -> list[dict[str, Any]]: \"\"\"Return list of APs with keys: channel, rssi, ssid (optional)\"\"\"","title":"Scanner Architecture"},{"location":"DEVELOPER_README/#available-adapters","text":"","title":"Available Adapters"},{"location":"DEVELOPER_README/#manualscanner","text":"Accepts pre-scanned data from user input. Usage: scanner = ManualScanner(scan_data=[ {\"channel\": 1, \"rssi\": -45, \"ssid\": \"Network1\"}, {\"channel\": 6, \"rssi\": -60} ]) aps = await scanner.scan()","title":"ManualScanner"},{"location":"DEVELOPER_README/#routerapiscanner","text":"Queries router APIs for scan data. Currently a placeholder for future router-specific implementations. Supported Router Types: - UniFi (planned) - OpenWrt (planned) - Fritz!Box (planned) Adding Router Support: Extend RouterAPIScanner.scan() to add router-specific API calls: async def scan(self) -> list[dict[str, Any]]: if self.router_type == \"unifi\": return await self._scan_unifi() elif self.router_type == \"openwrt\": return await self._scan_openwrt() # ...","title":"RouterAPIScanner"},{"location":"DEVELOPER_README/#hostscanner","text":"Scans Wi-Fi using host system tools (iwlist or nmcli). Requirements: - Linux host with Wi-Fi adapter - iwlist (wireless-tools) or nmcli (NetworkManager) installed - Appropriate permissions (may require privileged add-on) Permissions: - iwlist : Typically requires root or CAP_NET_ADMIN capability - nmcli : Usually works without elevated permissions if NetworkManager is running","title":"HostScanner"},{"location":"DEVELOPER_README/#factory-function","text":"Use create_scanner() to instantiate the appropriate scanner: from custom_components.zigsight.wifi_scanner import create_scanner # Manual mode scanner = create_scanner( mode=\"manual\", scan_data=[{\"channel\": 1, \"rssi\": -45}] ) # Router API mode scanner = create_scanner( mode=\"router_api\", router_config={ \"router_type\": \"unifi\", \"host\": \"192.168.1.1\", \"username\": \"admin\", \"password\": \"secret\" } ) # Host scan mode scanner = create_scanner( mode=\"host_scan\", host_config={\"interface\": \"wlan0\"} )","title":"Factory Function"},{"location":"DEVELOPER_README/#adding-a-new-router-adapter","text":"Identify the API endpoint for Wi-Fi scanning in your router Add authentication logic in RouterAPIScanner.__init__() Implement the scan method for your router type: async def _scan_your_router(self) -> list[dict[str, Any]]: \"\"\"Scan using YourRouter API.\"\"\" async with aiohttp.ClientSession() as session: # Authenticate auth_data = await self._authenticate_your_router(session) # Query scan endpoint async with session.get( f\"http://{self.host}/api/wifi/scan\", headers={\"Authorization\": f\"Bearer {auth_data['token']}\"} ) as response: data = await response.json() # Parse response into standard format return [ { \"channel\": ap[\"chan\"], \"rssi\": ap[\"signal\"], \"ssid\": ap.get(\"name\") } for ap in data[\"access_points\"] ] Add router type to RouterAPIScanner.scan() dispatch logic Add tests in tests/test_wifi_scanner.py Document in docs/wifi_recommendation.md","title":"Adding a New Router Adapter"},{"location":"DEVELOPER_README/#testing-scanner-adapters","text":"See tests/test_wifi_scanner.py for comprehensive test coverage: @pytest.mark.asyncio async def test_your_scanner() -> None: scanner = YourScanner(config) result = await scanner.scan() assert isinstance(result, list) for ap in result: assert \"channel\" in ap assert \"rssi\" in ap","title":"Testing Scanner Adapters"},{"location":"DEVELOPER_README/#channel-recommender-algorithm","text":"The channel recommender in recommender.py uses frequency overlap analysis to score Zigbee channels.","title":"Channel Recommender Algorithm"},{"location":"DEVELOPER_README/#algorithm-overview","text":"Calculate Overlap Factor for each Wi-Fi AP and Zigbee channel pair: Compute frequency distance between channels Apply overlap percentage based on bandwidth (Wi-Fi ~22 MHz, Zigbee ~2 MHz) Factor in signal strength (RSSI) Score Each Zigbee Channel (11, 15, 20, 25): Sum overlap factors from all Wi-Fi APs Lower score = less interference Select Best Channel : Choose channel with lowest score Generate human-readable explanation","title":"Algorithm Overview"},{"location":"DEVELOPER_README/#key-functions","text":"","title":"Key Functions"},{"location":"DEVELOPER_README/#calculate_overlap_factorwifi_channel-zigbee_channel-rssi","text":"Returns interference factor (0-100) for a single Wi-Fi AP and Zigbee channel pair. Formula: freq_distance = abs(wifi_freq - zigbee_freq) overlap_percentage = max(0, 1 - (freq_distance / 22)) normalized_rssi = (rssi + 90) * 100 / 60 # -30 to -90 dBm range interference_factor = overlap_percentage * normalized_rssi","title":"calculate_overlap_factor(wifi_channel, zigbee_channel, rssi)"},{"location":"DEVELOPER_README/#score_zigbee_channelzigbee_channel-wifi_aps","text":"Returns total interference score (0-100) for a Zigbee channel considering all Wi-Fi APs.","title":"score_zigbee_channel(zigbee_channel, wifi_aps)"},{"location":"DEVELOPER_README/#recommend_zigbee_channelwifi_aps","text":"Returns dict with recommended_channel , scores , and explanation .","title":"recommend_zigbee_channel(wifi_aps)"},{"location":"DEVELOPER_README/#frequency-mappings","text":"Wi-Fi (2.4 GHz): - Channel 1: 2412 MHz - Channel 6: 2437 MHz (most common) - Channel 11: 2462 MHz - Channels 1-13 supported (14 in Japan) Zigbee (2.4 GHz): - Channel 11: 2405 MHz (recommended) - Channel 15: 2425 MHz (recommended) - Channel 20: 2450 MHz (recommended) - Channel 25: 2475 MHz (recommended) - Channels 12-24, 26 available but not recommended","title":"Frequency Mappings"},{"location":"DEVELOPER_README/#frontend-development","text":"ZigSight includes a custom Lovelace card for network topology visualization.","title":"Frontend Development"},{"location":"DEVELOPER_README/#card-location","text":"The topology card is located at: custom_components/zigsight/www/topology-card.js","title":"Card Location"},{"location":"DEVELOPER_README/#no-build-process-required","text":"The topology card is written in vanilla JavaScript and requires no build process. It can be directly loaded by Home Assistant as a Lovelace resource.","title":"No Build Process Required"},{"location":"DEVELOPER_README/#card-registration","text":"The card is automatically registered when loaded. Users need to: Copy the card to their www/ directory: bash mkdir -p config/www/community/zigsight cp custom_components/zigsight/www/topology-card.js config/www/community/zigsight/ Register as a Lovelace resource in configuration.yaml : ```yaml lovelace: mode: yaml resources: url: /local/community/zigsight/topology-card.js type: module ``` Or via UI: Settings \u2192 Dashboards \u2192 Resources \u2192 Add Resource","title":"Card Registration"},{"location":"DEVELOPER_README/#card-usage","text":"Add to any dashboard: type: custom:zigsight-topology-card title: Zigbee Network Topology","title":"Card Usage"},{"location":"DEVELOPER_README/#card-development","text":"To modify the card: Edit custom_components/zigsight/www/topology-card.js Copy updated file to Home Assistant's www/ directory Clear browser cache or use incognito mode Refresh the dashboard","title":"Card Development"},{"location":"DEVELOPER_README/#card-features","text":"Network Statistics : Shows device counts by type Device Cards : Interactive cards for each device with metrics Color Coding : Visual indicators for device type and health Device Details : Click any device to see detailed information Link Quality : Color-coded signal strength indicators Warnings : Highlights devices with connectivity or battery issues","title":"Card Features"},{"location":"DEVELOPER_README/#api-endpoint","text":"The card fetches data from /api/zigsight/topology which returns: - Node list with device information - Edge list with parent-child relationships - Network statistics See docs/ui.md for complete API documentation.","title":"API Endpoint"},{"location":"DEVELOPER_README/#testing-frontend-changes","text":"Since there's no build process, testing is straightforward: Copy the updated card to Home Assistant Reload the dashboard Check browser console for errors Test all interactive features","title":"Testing Frontend Changes"},{"location":"DEVELOPER_README/#future-enhancements","text":"Potential improvements for the topology card: Interactive graph visualization (D3.js, vis-network) Device filtering and search Automatic refresh intervals Export topology as image Historical topology comparison Custom color schemes","title":"Future Enhancements"},{"location":"DEVELOPER_README/#automation-blueprints","text":"ZigSight includes pre-built Home Assistant automation blueprints in the automations/ directory.","title":"Automation Blueprints"},{"location":"DEVELOPER_README/#blueprint-location","text":"Blueprints are stored in: automations/ \u251c\u2500\u2500 README.md # Overview and import instructions \u251c\u2500\u2500 battery_drain.yaml # Battery low alert blueprint \u251c\u2500\u2500 reconnect_flap.yaml # Device flapping detection blueprint \u2514\u2500\u2500 network_health_daily_report.yaml # Daily network health report blueprint","title":"Blueprint Location"},{"location":"DEVELOPER_README/#blueprint-structure","text":"Each blueprint follows the Home Assistant blueprint schema: blueprint: name: Blueprint Name description: Description of what the blueprint does domain: automation author: ZigSight source_url: https://github.com/mmornati/zigsight/blob/main/automations/blueprint.yaml input: input_name: name: Human Readable Name description: What this input controls default: default_value selector: # Input selector type trigger: # Trigger configuration condition: # Optional conditions action: # Actions to perform","title":"Blueprint Structure"},{"location":"DEVELOPER_README/#creating-a-new-blueprint","text":"Create the blueprint file in automations/ : bash touch automations/my_new_blueprint.yaml Define the blueprint metadata : name : Short, descriptive name description : What the blueprint does domain : Always automation for automation blueprints author : \"ZigSight\" source_url : Link to the file on GitHub Define inputs with appropriate selectors: entity : Entity picker number : Numeric input with min/max/step text : Free text input boolean : Toggle switch time : Time picker select : Dropdown selection Add triggers, conditions, and actions using the inputs: ```yaml trigger: platform: state entity_id: !input my_entity_input ``` Test the blueprint : Import into Home Assistant Create an automation from it Verify all inputs work correctly Add tests in tests/test_blueprints.yaml : python def test_my_blueprint_yaml_valid(): \"\"\"Test that my_blueprint.yaml is valid YAML.\"\"\" blueprint_path = Path(\"automations/my_new_blueprint.yaml\") with blueprint_path.open() as f: data = yaml.safe_load(f) assert \"blueprint\" in data assert \"trigger\" in data assert \"action\" in data Update documentation : Add to automations/README.md Add configuration reference to docs/automations.md","title":"Creating a New Blueprint"},{"location":"DEVELOPER_README/#blueprint-testing","text":"Blueprint YAML files are validated in CI: # Run blueprint validation tests pytest tests/test_blueprints.py -v Tests verify: - YAML syntax is valid - Required blueprint keys are present - Input definitions are properly formatted - Triggers and actions are defined","title":"Blueprint Testing"},{"location":"DEVELOPER_README/#user-documentation","text":"User-facing documentation is in docs/automations.md , which covers: - How to import blueprints - How to create automations from blueprints - Configuration reference for each blueprint - Customization examples","title":"User Documentation"},{"location":"DEVELOPER_README/#documentation-site","text":"ZigSight documentation is built using MkDocs and automatically deployed to GitHub Pages.","title":"Documentation Site"},{"location":"DEVELOPER_README/#viewing-the-documentation","text":"The documentation site is available at: https://mmornati.github.io/zigsight/","title":"Viewing the Documentation"},{"location":"DEVELOPER_README/#building-documentation-locally","text":"To preview documentation changes locally: # Install documentation dependencies pip install -r requirements-docs.txt # Start the development server mkdocs serve # Or build the static site mkdocs build The development server runs at http://127.0.0.1:8000/ with live reload.","title":"Building Documentation Locally"},{"location":"DEVELOPER_README/#documentation-structure","text":"Documentation files are in the docs/ directory: docs/ \u251c\u2500\u2500 index.md # Homepage \u251c\u2500\u2500 getting_started.md # Installation guide \u251c\u2500\u2500 analytics.md # Analytics engine documentation \u251c\u2500\u2500 wifi_recommendation.md # Wi-Fi channel recommendation guide \u251c\u2500\u2500 ui.md # Network topology card documentation \u251c\u2500\u2500 automations.md # Automation blueprints guide \u251c\u2500\u2500 faq.md # Frequently asked questions \u251c\u2500\u2500 DEVELOPER_README.md # This file \u2514\u2500\u2500 integrations/ \u251c\u2500\u2500 zigbee2mqtt.md # Zigbee2MQTT integration guide \u251c\u2500\u2500 zha.md # ZHA integration guide \u2514\u2500\u2500 deconz.md # deCONZ integration guide","title":"Documentation Structure"},{"location":"DEVELOPER_README/#adding-or-editing-pages","text":"Create or edit markdown files in the docs/ directory Update mkdocs.yml navigation if adding new pages Test locally with mkdocs serve Submit a pull request","title":"Adding or Editing Pages"},{"location":"DEVELOPER_README/#deployment-workflow","text":"Documentation is automatically deployed via the .github/workflows/deploy-docs.yaml workflow: Trigger : Push to main branch that modifies docs/** , mkdocs.yml , or requirements-docs.txt Build : MkDocs builds the static site with mkdocs build --strict Deploy : The peaceiris/actions-gh-pages action publishes to the gh-pages branch Hosting : GitHub Pages serves the site from the gh-pages branch The workflow can also be triggered manually via workflow_dispatch .","title":"Deployment Workflow"},{"location":"DEVELOPER_README/#mkdocs-configuration","text":"The documentation configuration is in mkdocs.yml : Theme : ReadTheDocs theme Plugins : Search Extensions : Tables, fenced code blocks, admonitions, table of contents","title":"MkDocs Configuration"},{"location":"DEVELOPER_README/#documentation-requirements","text":"Documentation dependencies are in requirements-docs.txt : mkdocs>=1.5.0","title":"Documentation Requirements"},{"location":"DEVELOPER_README/#zha-integration-support","text":"ZigSight supports collecting device diagnostics from the Zigbee Home Automation (ZHA) integration alongside Zigbee2MQTT.","title":"ZHA Integration Support"},{"location":"DEVELOPER_README/#architecture","text":"The ZHA collector ( zha_collector.py ) implements a polling-based approach to gather device metrics: \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Coordinator \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 v v \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 MQTT \u2502 \u2502 ZHA \u2502 \u2502 Collector\u2502 \u2502 Collector \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 v v \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Device Metrics \u2502 \u2502 (Normalized Format) \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518","title":"Architecture"},{"location":"DEVELOPER_README/#zha-collector-implementation","text":"The ZHACollector class provides:","title":"ZHA Collector Implementation"},{"location":"DEVELOPER_README/#key-methods","text":"is_available() -> bool Checks if ZHA integration is loaded by testing \"zha\" in hass.data . collect_devices() -> dict[str, dict[str, Any]] Collects all ZHA devices and their metrics: 1. Access hass.data[\"zha\"][\"gateway\"] 2. Iterate through gateway.devices 3. For each device, collect metrics from: - Device attributes ( lqi , rssi , last_seen ) - Diagnostic entities ( sensor.<device>_rssi , etc.) 4. Normalize metrics to coordinator format _collect_device_metrics(zha_device) -> dict[str, Any] Extracts metrics from ZHA device attributes: - lqi \u2192 link_quality - rssi \u2192 rssi - last_seen \u2192 ISO 8601 timestamp _collect_entity_metrics(ieee: str) -> dict[str, Any] Reads diagnostic entities from device/entity registries: 1. Find device by IEEE address in device registry 2. Get entities for device from entity registry 3. Read entity states for RSSI, LQI, battery","title":"Key Methods"},{"location":"DEVELOPER_README/#metric-normalization","text":"ZHA metrics are normalized to match Zigbee2MQTT format for consistency: ZHA Source Normalized Name Type zha_device.lqi link_quality int (0-255) zha_device.rssi rssi int (dBm) zha_device.last_seen last_seen ISO 8601 string sensor.<device>_battery battery float (%)","title":"Metric Normalization"},{"location":"DEVELOPER_README/#coordinator-integration","text":"The coordinator integrates ZHA collection through: Configuration coordinator = ZigSightCoordinator( hass, enable_zha=True, # Enable ZHA collection ... ) Update Cycle async def _async_update_data(self) -> dict[str, Any]: # Collect ZHA devices if enabled if self._enable_zha and self._zha_collector: await self._collect_zha_devices() # ... continue with MQTT and analytics Device Processing def _process_zha_device_update(self, device_id: str, device_data: dict): # Process ZHA device similar to MQTT devices # - Track reconnections # - Store metrics # - Update history # - Fire events","title":"Coordinator Integration"},{"location":"DEVELOPER_README/#zha-api-usage","text":"ZigSight uses the following Home Assistant APIs for ZHA: Stable APIs (Public) - device_registry.async_get(hass) - Get device registry - entity_registry.async_get(hass) - Get entity registry - device_registry.async_get_device(identifiers) - Find device by ID - entity_registry.async_entries_for_device(device_id) - Get device entities - hass.states.get(entity_id) - Read entity state Internal APIs (May Change) - hass.data[\"zha\"] - Access ZHA integration data - hass.data[\"zha\"][\"gateway\"] - Access ZHA gateway - gateway.devices - Iterate ZHA devices - zha_device.lqi , zha_device.rssi - Device attributes","title":"ZHA API Usage"},{"location":"DEVELOPER_README/#handling-zha-changes","text":"If ZHA internals change in future Home Assistant versions: Check ZHA integration release notes for API changes Update ZHACollector methods to match new APIs Add version checks if supporting multiple HA versions: python from homeassistant.const import __version__ if __version__ >= \"2025.1.0\": # New API else: # Legacy API Update tests to cover new behavior Document changes in docs/integrations/zha.md","title":"Handling ZHA Changes"},{"location":"DEVELOPER_README/#testing-zha-collector","text":"Tests use mocks to simulate ZHA integration: # Mock ZHA gateway mock_gateway = MagicMock() mock_gateway.devices = {ieee: mock_device} mock_hass.data[\"zha\"] = {\"gateway\": mock_gateway} # Mock device attributes mock_device.lqi = 200 mock_device.rssi = -50 mock_device.last_seen = datetime.now() # Test collection collector = ZHACollector(mock_hass) devices = await collector.collect_devices() See tests/test_zha_collector.py for comprehensive test coverage.","title":"Testing ZHA Collector"},{"location":"DEVELOPER_README/#performance-considerations_1","text":"Polling interval : ZHA collection runs on coordinator update cycle (60s default) Device count : Tested with up to 50 devices; larger networks may need tuning Registry access : Device/entity registry lookups are cached by Home Assistant Entity state reads : Minimal overhead, reads from state machine","title":"Performance Considerations"},{"location":"DEVELOPER_README/#future-enhancements_1","text":"Potential improvements for ZHA support: Network topology : Extract parent-child relationships from ZHA Route table : Access ZHA routing information Device statistics : Collect packet loss, retry counts Event-based updates : Subscribe to ZHA device events instead of polling Deeper integration : Use ZHA's internal state tracking","title":"Future Enhancements"},{"location":"DEVELOPER_README/#contributing","text":"Create a feature branch: git checkout -b feature/your-feature-name Make your changes Run tests and linting locally Commit your changes: git commit -m \"Add feature: description\" Push to GitHub: git push origin feature/your-feature-name Create a Pull Request","title":"Contributing"},{"location":"DEVELOPER_README/#resources","text":"Home Assistant Developer Documentation Home Assistant Integration Architecture Pytest Documentation Ruff Documentation Wi-Fi/Zigbee Coexistence","title":"Resources"},{"location":"analytics/","text":"ZigSight Analytics \u00b6 ZigSight provides powerful analytics capabilities to monitor and diagnose Zigbee device health and connectivity issues. Overview \u00b6 The analytics engine processes device metrics over time to compute derived insights: Reconnect Rate : Frequency of device reconnections per hour Battery Trend : Rate of battery drain (percentage per hour) Health Score : Aggregated health metric (0-100) combining multiple factors Battery Drain Warning : Binary alert when battery drain exceeds threshold Connectivity Warning : Binary alert when connectivity issues are detected Metrics \u00b6 Reconnect Rate \u00b6 Sensor : sensor.<device>_reconnect_rate Unit : events/hour Description : Measures how often a device reconnects to the network over a sliding time window. Default Window : 24 hours Calculation : Counts reconnection events (gaps > 5 minutes between updates) within the window and divides by window duration. Example : - A device that reconnects 12 times in 24 hours = 0.5 events/hour - A device that reconnects 240 times in 24 hours = 10 events/hour (high, indicates connectivity issues) Battery Trend \u00b6 Sensor : sensor.<device>_battery_trend Unit : %/hour Description : Rate of battery drain computed using linear regression over the last 24 hours. Algorithm : - Extracts battery readings from device history - Filters readings with battery \u2265 20% (below threshold, readings may be unreliable) - Computes linear regression slope to determine trend - Returns percentage change per hour (negative = draining) Example : - -0.5 = Battery draining at 0.5% per hour - -2.0 = Battery draining at 2% per hour (concerning for low battery devices) - None = Insufficient data to compute trend Health Score \u00b6 Sensor : sensor.<device>_health_score Unit : None (0-100 scale) Description : Aggregated health metric combining multiple device factors. Components (default weights): - Link Quality (30%): Normalized signal strength (0-255 \u2192 0-100) - Battery (20%): Current battery level (0-100%) - Reconnect Rate (30%): Inverted reconnect rate (lower is better) - Connectivity (20%): Based on last_seen recency (< 5 min = 100, > 1 hour = 0) Score Interpretation : - 90-100 : Excellent health - 70-89 : Good health - 50-69 : Fair health (monitor closely) - 0-49 : Poor health (investigate issues) Example : Device with: - Link Quality: 200/255 \u2192 78.4 score - Battery: 80% - Reconnect Rate: 0.5/hour \u2192 95 score - Connectivity: Seen 2 min ago \u2192 100 score Health Score = (78.4 \u00d7 0.3) + (80 \u00d7 0.2) + (95 \u00d7 0.3) + (100 \u00d7 0.2) = 86.6 Warnings \u00b6 Battery Drain Warning \u00b6 Binary Sensor : binary_sensor.<device>_battery_drain_warning Device Class : problem Description : Triggers when battery drain rate exceeds configured threshold. Default Threshold : 10%/hour Configuration : Set via battery_drain_threshold in integration options When It Triggers : - Battery trend < -10%/hour (default) - Example: Device battery dropped from 80% to 50% in 3 hours = -10%/hour Troubleshooting : - Check device placement (poor signal increases power usage) - Verify battery is not defective - Review device logs for transmission errors - Consider replacing battery if drain persists Connectivity Warning \u00b6 Binary Sensor : binary_sensor.<device>_connectivity_warning Device Class : connectivity Description : Triggers when connectivity issues are detected. Default Threshold : 5 events/hour Configuration : Set via reconnect_rate_threshold in integration options When It Triggers : - Reconnect rate \u2265 5 events/hour (default) - OR device hasn't been seen for > 1 hour Troubleshooting : - Check device distance from coordinator - Verify Zigbee channel interference - Review link quality metrics - Check for physical obstructions - Verify device firmware is up to date Configuration \u00b6 Threshold Configuration \u00b6 All thresholds are configurable during integration setup or via options flow: Battery Drain Threshold : Minimum drain rate (%/hour) to trigger warning (default: 10.0) Reconnect Rate Threshold : Maximum reconnect rate (events/hour) before warning (default: 5.0) Reconnect Rate Window : Time window in hours for reconnect rate calculation (default: 24) Tuning Thresholds \u00b6 For Stable Networks : - Reduce reconnect_rate_threshold to 2-3 events/hour - Reduce battery_drain_threshold to 5-7%/hour for better early detection For Noisy Networks : - Increase reconnect_rate_threshold to 10+ events/hour - Increase battery_drain_threshold to 15+/hour to avoid false positives For Battery-Optimized Monitoring : - Use longer reconnect_rate_window_hours (48-72) for better averaging - Adjust battery_drain_threshold based on device type (motion sensors drain faster than door sensors) Worked Examples \u00b6 Example 1: Detecting Battery Issues \u00b6 Scenario : Door sensor battery drains quickly after installation. Setup : battery_drain_threshold: 8.0 # More sensitive Monitoring : 1. Check sensor.door_sensor_battery_trend \u2192 Shows -2.5 %/hour 2. Check binary_sensor.door_sensor_battery_drain_warning \u2192 ON 3. Check sensor.door_sensor_battery \u2192 Shows 45% Action : Battery is draining at 2.5%/hour, triggering warning. Check device placement and signal quality. Example 2: Identifying Connectivity Problems \u00b6 Scenario : Motion sensor frequently disconnects and reconnects. Setup : reconnect_rate_threshold: 5.0 reconnect_rate_window_hours: 24 Monitoring : 1. Check sensor.motion_sensor_reconnect_rate \u2192 Shows 12.5 events/hour 2. Check binary_sensor.motion_sensor_connectivity_warning \u2192 ON 3. Check sensor.motion_sensor_health_score \u2192 Shows 35 (poor) Action : High reconnect rate (12.5/hour) indicates connectivity issues. Check signal strength and device placement. Example 3: Health Score Trend Analysis \u00b6 Scenario : Monitoring overall device health over time. Setup : - Track sensor.<device>_health_score in Home Assistant history - Create automations based on score thresholds Monitoring : - Device starts at 85 (good) - Over 1 week, score drops to 60 (fair) - Check individual components: - Link quality: Stable at 75 - Battery: Dropped from 90% to 65% - Reconnect rate: Increased from 0.2 to 2.0/hour Action : Battery and connectivity are degrading. Investigate root causes. Troubleshooting \u00b6 Metrics Show \"Unknown\" \u00b6 Cause : Insufficient historical data. Solution : - Wait for more device updates (analytics needs at least 2-3 data points) - Verify MQTT connection is working - Check device is sending regular updates Health Score Seems Inaccurate \u00b6 Cause : Default weights may not fit your use case. Solution : - Review individual component scores (link quality, battery, reconnect rate, connectivity) - Consider your network priorities (battery life vs. connectivity) - Note: Weights are currently fixed in code but may be configurable in future versions Warnings Trigger Too Frequently \u00b6 Cause : Thresholds too sensitive for your environment. Solution : - Increase thresholds via integration options - Review device logs to understand normal behavior - Adjust based on device type (motion sensors behave differently than door sensors) Battery Trend Not Available \u00b6 Cause : Battery readings below minimum threshold or insufficient data. Solution : - Ensure device reports battery level - Wait for more historical data points - Check if battery is below 20% (trend calculation minimum) Data Retention \u00b6 Analytics calculations use device history stored in memory: Maximum History : 1000 entries per device (last entries kept) Retention Period : Configurable via retention_days (default: 30 days) Memory Usage : Approximately 10-50 KB per device depending on history size For persistent storage and long-term analysis, use Home Assistant's built-in history features to record sensor values. Future Enhancements \u00b6 Potential future improvements: Configurable health score weights Additional metrics (route stability, router load) Predictive battery life estimation Anomaly detection for unusual patterns Historical trend visualization Integration with Home Assistant automations for proactive alerts","title":"Analytics"},{"location":"analytics/#zigsight-analytics","text":"ZigSight provides powerful analytics capabilities to monitor and diagnose Zigbee device health and connectivity issues.","title":"ZigSight Analytics"},{"location":"analytics/#overview","text":"The analytics engine processes device metrics over time to compute derived insights: Reconnect Rate : Frequency of device reconnections per hour Battery Trend : Rate of battery drain (percentage per hour) Health Score : Aggregated health metric (0-100) combining multiple factors Battery Drain Warning : Binary alert when battery drain exceeds threshold Connectivity Warning : Binary alert when connectivity issues are detected","title":"Overview"},{"location":"analytics/#metrics","text":"","title":"Metrics"},{"location":"analytics/#reconnect-rate","text":"Sensor : sensor.<device>_reconnect_rate Unit : events/hour Description : Measures how often a device reconnects to the network over a sliding time window. Default Window : 24 hours Calculation : Counts reconnection events (gaps > 5 minutes between updates) within the window and divides by window duration. Example : - A device that reconnects 12 times in 24 hours = 0.5 events/hour - A device that reconnects 240 times in 24 hours = 10 events/hour (high, indicates connectivity issues)","title":"Reconnect Rate"},{"location":"analytics/#battery-trend","text":"Sensor : sensor.<device>_battery_trend Unit : %/hour Description : Rate of battery drain computed using linear regression over the last 24 hours. Algorithm : - Extracts battery readings from device history - Filters readings with battery \u2265 20% (below threshold, readings may be unreliable) - Computes linear regression slope to determine trend - Returns percentage change per hour (negative = draining) Example : - -0.5 = Battery draining at 0.5% per hour - -2.0 = Battery draining at 2% per hour (concerning for low battery devices) - None = Insufficient data to compute trend","title":"Battery Trend"},{"location":"analytics/#health-score","text":"Sensor : sensor.<device>_health_score Unit : None (0-100 scale) Description : Aggregated health metric combining multiple device factors. Components (default weights): - Link Quality (30%): Normalized signal strength (0-255 \u2192 0-100) - Battery (20%): Current battery level (0-100%) - Reconnect Rate (30%): Inverted reconnect rate (lower is better) - Connectivity (20%): Based on last_seen recency (< 5 min = 100, > 1 hour = 0) Score Interpretation : - 90-100 : Excellent health - 70-89 : Good health - 50-69 : Fair health (monitor closely) - 0-49 : Poor health (investigate issues) Example : Device with: - Link Quality: 200/255 \u2192 78.4 score - Battery: 80% - Reconnect Rate: 0.5/hour \u2192 95 score - Connectivity: Seen 2 min ago \u2192 100 score Health Score = (78.4 \u00d7 0.3) + (80 \u00d7 0.2) + (95 \u00d7 0.3) + (100 \u00d7 0.2) = 86.6","title":"Health Score"},{"location":"analytics/#warnings","text":"","title":"Warnings"},{"location":"analytics/#battery-drain-warning","text":"Binary Sensor : binary_sensor.<device>_battery_drain_warning Device Class : problem Description : Triggers when battery drain rate exceeds configured threshold. Default Threshold : 10%/hour Configuration : Set via battery_drain_threshold in integration options When It Triggers : - Battery trend < -10%/hour (default) - Example: Device battery dropped from 80% to 50% in 3 hours = -10%/hour Troubleshooting : - Check device placement (poor signal increases power usage) - Verify battery is not defective - Review device logs for transmission errors - Consider replacing battery if drain persists","title":"Battery Drain Warning"},{"location":"analytics/#connectivity-warning","text":"Binary Sensor : binary_sensor.<device>_connectivity_warning Device Class : connectivity Description : Triggers when connectivity issues are detected. Default Threshold : 5 events/hour Configuration : Set via reconnect_rate_threshold in integration options When It Triggers : - Reconnect rate \u2265 5 events/hour (default) - OR device hasn't been seen for > 1 hour Troubleshooting : - Check device distance from coordinator - Verify Zigbee channel interference - Review link quality metrics - Check for physical obstructions - Verify device firmware is up to date","title":"Connectivity Warning"},{"location":"analytics/#configuration","text":"","title":"Configuration"},{"location":"analytics/#threshold-configuration","text":"All thresholds are configurable during integration setup or via options flow: Battery Drain Threshold : Minimum drain rate (%/hour) to trigger warning (default: 10.0) Reconnect Rate Threshold : Maximum reconnect rate (events/hour) before warning (default: 5.0) Reconnect Rate Window : Time window in hours for reconnect rate calculation (default: 24)","title":"Threshold Configuration"},{"location":"analytics/#tuning-thresholds","text":"For Stable Networks : - Reduce reconnect_rate_threshold to 2-3 events/hour - Reduce battery_drain_threshold to 5-7%/hour for better early detection For Noisy Networks : - Increase reconnect_rate_threshold to 10+ events/hour - Increase battery_drain_threshold to 15+/hour to avoid false positives For Battery-Optimized Monitoring : - Use longer reconnect_rate_window_hours (48-72) for better averaging - Adjust battery_drain_threshold based on device type (motion sensors drain faster than door sensors)","title":"Tuning Thresholds"},{"location":"analytics/#worked-examples","text":"","title":"Worked Examples"},{"location":"analytics/#example-1-detecting-battery-issues","text":"Scenario : Door sensor battery drains quickly after installation. Setup : battery_drain_threshold: 8.0 # More sensitive Monitoring : 1. Check sensor.door_sensor_battery_trend \u2192 Shows -2.5 %/hour 2. Check binary_sensor.door_sensor_battery_drain_warning \u2192 ON 3. Check sensor.door_sensor_battery \u2192 Shows 45% Action : Battery is draining at 2.5%/hour, triggering warning. Check device placement and signal quality.","title":"Example 1: Detecting Battery Issues"},{"location":"analytics/#example-2-identifying-connectivity-problems","text":"Scenario : Motion sensor frequently disconnects and reconnects. Setup : reconnect_rate_threshold: 5.0 reconnect_rate_window_hours: 24 Monitoring : 1. Check sensor.motion_sensor_reconnect_rate \u2192 Shows 12.5 events/hour 2. Check binary_sensor.motion_sensor_connectivity_warning \u2192 ON 3. Check sensor.motion_sensor_health_score \u2192 Shows 35 (poor) Action : High reconnect rate (12.5/hour) indicates connectivity issues. Check signal strength and device placement.","title":"Example 2: Identifying Connectivity Problems"},{"location":"analytics/#example-3-health-score-trend-analysis","text":"Scenario : Monitoring overall device health over time. Setup : - Track sensor.<device>_health_score in Home Assistant history - Create automations based on score thresholds Monitoring : - Device starts at 85 (good) - Over 1 week, score drops to 60 (fair) - Check individual components: - Link quality: Stable at 75 - Battery: Dropped from 90% to 65% - Reconnect rate: Increased from 0.2 to 2.0/hour Action : Battery and connectivity are degrading. Investigate root causes.","title":"Example 3: Health Score Trend Analysis"},{"location":"analytics/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"analytics/#metrics-show-unknown","text":"Cause : Insufficient historical data. Solution : - Wait for more device updates (analytics needs at least 2-3 data points) - Verify MQTT connection is working - Check device is sending regular updates","title":"Metrics Show \"Unknown\""},{"location":"analytics/#health-score-seems-inaccurate","text":"Cause : Default weights may not fit your use case. Solution : - Review individual component scores (link quality, battery, reconnect rate, connectivity) - Consider your network priorities (battery life vs. connectivity) - Note: Weights are currently fixed in code but may be configurable in future versions","title":"Health Score Seems Inaccurate"},{"location":"analytics/#warnings-trigger-too-frequently","text":"Cause : Thresholds too sensitive for your environment. Solution : - Increase thresholds via integration options - Review device logs to understand normal behavior - Adjust based on device type (motion sensors behave differently than door sensors)","title":"Warnings Trigger Too Frequently"},{"location":"analytics/#battery-trend-not-available","text":"Cause : Battery readings below minimum threshold or insufficient data. Solution : - Ensure device reports battery level - Wait for more historical data points - Check if battery is below 20% (trend calculation minimum)","title":"Battery Trend Not Available"},{"location":"analytics/#data-retention","text":"Analytics calculations use device history stored in memory: Maximum History : 1000 entries per device (last entries kept) Retention Period : Configurable via retention_days (default: 30 days) Memory Usage : Approximately 10-50 KB per device depending on history size For persistent storage and long-term analysis, use Home Assistant's built-in history features to record sensor values.","title":"Data Retention"},{"location":"analytics/#future-enhancements","text":"Potential future improvements: Configurable health score weights Additional metrics (route stability, router load) Predictive battery life estimation Anomaly detection for unusual patterns Historical trend visualization Integration with Home Assistant automations for proactive alerts","title":"Future Enhancements"},{"location":"automations/","text":"ZigSight Automations Guide \u00b6 This guide explains how to use the ZigSight automation blueprints to monitor your Zigbee network and receive alerts. Overview \u00b6 ZigSight provides three automation blueprints for common monitoring scenarios: Battery Drain Alert - Notifies when device batteries fall below a threshold Reconnect Flap Alert - Detects devices that frequently disconnect/reconnect Daily Network Health Report - Sends a daily summary of your network status Importing Blueprints \u00b6 Method 1: Home Assistant UI (Recommended) \u00b6 Navigate to Settings \u2192 Automations & Scenes \u2192 Blueprints Click Import Blueprint (bottom right corner) Paste the blueprint URL: Blueprint Import URL Battery Drain https://raw.githubusercontent.com/mmornati/zigsight/main/automations/battery_drain.yaml Reconnect Flap https://raw.githubusercontent.com/mmornati/zigsight/main/automations/reconnect_flap.yaml Daily Report https://raw.githubusercontent.com/mmornati/zigsight/main/automations/network_health_daily_report.yaml Click Preview Blueprint , then Import Blueprint Method 2: Manual File Copy \u00b6 Copy the blueprint files to your Home Assistant configuration: # Create the blueprint directory mkdir -p /config/blueprints/automation/zigsight/ # Copy blueprints (from the repository) cp automations/battery_drain.yaml /config/blueprints/automation/zigsight/ cp automations/reconnect_flap.yaml /config/blueprints/automation/zigsight/ cp automations/network_health_daily_report.yaml /config/blueprints/automation/zigsight/ Restart Home Assistant or reload automations to see the new blueprints. Creating Automations from Blueprints \u00b6 Via Home Assistant UI \u00b6 Go to Settings \u2192 Automations & Scenes \u2192 Automations Click Create Automation \u2192 Use Blueprint Select the ZigSight blueprint you want to use Configure the inputs as described below Click Save Via YAML \u00b6 You can also create automations directly in your automations.yaml : # Example: Battery drain alert for a specific device - id: zigsight_battery_alert_motion_sensor alias: \"ZigSight: Motion Sensor Battery Alert\" use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.motion_sensor_battery battery_threshold: 20 notify_service: notify.mobile_app_phone notification_title: \"Low Battery Alert\" cooldown_hours: 24 # Example: Reconnect flapping detection - id: zigsight_flap_alert_door_sensor alias: \"ZigSight: Door Sensor Flap Alert\" use_blueprint: path: zigsight/reconnect_flap.yaml input: device_availability: binary_sensor.door_sensor_availability reconnect_count_threshold: 5 time_window_minutes: 60 notify_service: notify.mobile_app_phone cooldown_hours: 6 # Example: Daily network health report - id: zigsight_daily_report alias: \"ZigSight: Daily Network Report\" use_blueprint: path: zigsight/network_health_daily_report.yaml input: report_time: \"09:00:00\" low_battery_threshold: 30 offline_hours_threshold: 24 notify_service: notify.mobile_app_phone include_healthy_summary: true weekdays_only: false Blueprint Configuration Reference \u00b6 Battery Drain Alert \u00b6 Monitors a battery sensor and sends a notification when the level drops below a threshold. Input Description Default battery_sensor Battery level sensor entity to monitor Required battery_threshold Battery percentage trigger threshold 20% notify_service Notification service (e.g., notify.mobile_app ) Empty (uses persistent notification) notification_title Title for the notification \"ZigSight: Low Battery Alert\" cooldown_hours Hours between repeated alerts 24 Example notification: Motion Sensor battery is low at 15%. Consider replacing the battery soon. Reconnect Flap Alert \u00b6 Detects devices that reconnect too frequently, which may indicate interference or connectivity issues. Input Description Default device_availability Availability or connectivity entity Required reconnect_count_threshold Number of reconnects to trigger alert 5 time_window_minutes Time window for counting reconnects 60 notify_service Notification service Empty (uses persistent notification) notification_title Title for the notification \"ZigSight: Device Flapping Detected\" cooldown_hours Hours between repeated alerts 6 Example notification: Door Sensor has reconnected 7 times in the last 60 minutes. This may indicate interference or connectivity issues. Daily Network Health Report \u00b6 Sends a scheduled summary of your Zigbee network health. Input Description Default report_time Time to send the daily report 09:00:00 low_battery_threshold Battery level for flagging devices 30% offline_hours_threshold Hours offline to flag device 24 notify_service Notification service Empty (uses persistent notification) notification_title Title for the report \"ZigSight: Daily Network Health Report\" include_healthy_summary Include count of healthy devices true weekdays_only Only send on weekdays false Example report: \ud83d\udcca Network Health Report for 2024-01-15 **Overview:** \u2022 Total monitored devices: 25 \u2022 Healthy devices: 23 \u2022 Devices needing attention: 2 \u26a0\ufe0f **Low Battery Devices (< 30%):** \u2022 Motion Sensor Hallway \u2022 Contact Sensor Garage \ud83d\udca1 Tip: Consider replacing batteries in flagged devices soon. Notification Services \u00b6 The blueprints support any Home Assistant notification service. Common options: Service Description notify.mobile_app_<device> Push notification to mobile app notify.persistent_notification Home Assistant UI notification notify.telegram Telegram bot notification notify.pushover Pushover notification notify.slack Slack channel notification Leave the notify_service input empty to use persistent notifications (visible in the Home Assistant UI sidebar). Customization Tips \u00b6 Multiple Devices \u00b6 Create multiple automations from the same blueprint for different devices: # Kitchen motion sensor - id: battery_alert_kitchen use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.kitchen_motion_battery battery_threshold: 15 # Bedroom motion sensor - id: battery_alert_bedroom use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.bedroom_motion_battery battery_threshold: 20 Critical vs Non-Critical Devices \u00b6 Use different thresholds and notification services for critical devices: # Critical: Front door lock (immediate alert) - id: battery_critical_front_lock use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.front_door_lock_battery battery_threshold: 30 notify_service: notify.mobile_app_phone cooldown_hours: 12 # Non-critical: Outdoor temp sensor (weekly check) - id: battery_outdoor_temp use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.outdoor_temp_battery battery_threshold: 10 cooldown_hours: 168 Combining with Other Automations \u00b6 Use blueprint automations as triggers for more complex workflows: automation: - alias: \"Critical Battery - Turn on Warning Light\" trigger: - platform: persistent_notification notification_id: zigsight_battery_* action: - service: light.turn_on target: entity_id: light.warning_indicator data: color_name: red Troubleshooting \u00b6 Blueprint Not Appearing \u00b6 Verify the file is in the correct location ( blueprints/automation/zigsight/ ) Check for YAML syntax errors in the file Reload automations or restart Home Assistant Notifications Not Sending \u00b6 Verify your notification service is correctly configured Check the notification service name matches exactly Review Home Assistant logs for errors Too Many/Too Few Alerts \u00b6 Adjust the threshold and cooldown values: - Increase cooldown_hours to reduce alert frequency - Adjust battery_threshold to match your preferences - For reconnect alerts, increase reconnect_count_threshold or time_window_minutes See Also \u00b6 Getting Started - ZigSight installation and setup UI Documentation - Dashboard cards and visualization Developer README - Contributing to ZigSight","title":"Automations"},{"location":"automations/#zigsight-automations-guide","text":"This guide explains how to use the ZigSight automation blueprints to monitor your Zigbee network and receive alerts.","title":"ZigSight Automations Guide"},{"location":"automations/#overview","text":"ZigSight provides three automation blueprints for common monitoring scenarios: Battery Drain Alert - Notifies when device batteries fall below a threshold Reconnect Flap Alert - Detects devices that frequently disconnect/reconnect Daily Network Health Report - Sends a daily summary of your network status","title":"Overview"},{"location":"automations/#importing-blueprints","text":"","title":"Importing Blueprints"},{"location":"automations/#method-1-home-assistant-ui-recommended","text":"Navigate to Settings \u2192 Automations & Scenes \u2192 Blueprints Click Import Blueprint (bottom right corner) Paste the blueprint URL: Blueprint Import URL Battery Drain https://raw.githubusercontent.com/mmornati/zigsight/main/automations/battery_drain.yaml Reconnect Flap https://raw.githubusercontent.com/mmornati/zigsight/main/automations/reconnect_flap.yaml Daily Report https://raw.githubusercontent.com/mmornati/zigsight/main/automations/network_health_daily_report.yaml Click Preview Blueprint , then Import Blueprint","title":"Method 1: Home Assistant UI (Recommended)"},{"location":"automations/#method-2-manual-file-copy","text":"Copy the blueprint files to your Home Assistant configuration: # Create the blueprint directory mkdir -p /config/blueprints/automation/zigsight/ # Copy blueprints (from the repository) cp automations/battery_drain.yaml /config/blueprints/automation/zigsight/ cp automations/reconnect_flap.yaml /config/blueprints/automation/zigsight/ cp automations/network_health_daily_report.yaml /config/blueprints/automation/zigsight/ Restart Home Assistant or reload automations to see the new blueprints.","title":"Method 2: Manual File Copy"},{"location":"automations/#creating-automations-from-blueprints","text":"","title":"Creating Automations from Blueprints"},{"location":"automations/#via-home-assistant-ui","text":"Go to Settings \u2192 Automations & Scenes \u2192 Automations Click Create Automation \u2192 Use Blueprint Select the ZigSight blueprint you want to use Configure the inputs as described below Click Save","title":"Via Home Assistant UI"},{"location":"automations/#via-yaml","text":"You can also create automations directly in your automations.yaml : # Example: Battery drain alert for a specific device - id: zigsight_battery_alert_motion_sensor alias: \"ZigSight: Motion Sensor Battery Alert\" use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.motion_sensor_battery battery_threshold: 20 notify_service: notify.mobile_app_phone notification_title: \"Low Battery Alert\" cooldown_hours: 24 # Example: Reconnect flapping detection - id: zigsight_flap_alert_door_sensor alias: \"ZigSight: Door Sensor Flap Alert\" use_blueprint: path: zigsight/reconnect_flap.yaml input: device_availability: binary_sensor.door_sensor_availability reconnect_count_threshold: 5 time_window_minutes: 60 notify_service: notify.mobile_app_phone cooldown_hours: 6 # Example: Daily network health report - id: zigsight_daily_report alias: \"ZigSight: Daily Network Report\" use_blueprint: path: zigsight/network_health_daily_report.yaml input: report_time: \"09:00:00\" low_battery_threshold: 30 offline_hours_threshold: 24 notify_service: notify.mobile_app_phone include_healthy_summary: true weekdays_only: false","title":"Via YAML"},{"location":"automations/#blueprint-configuration-reference","text":"","title":"Blueprint Configuration Reference"},{"location":"automations/#battery-drain-alert","text":"Monitors a battery sensor and sends a notification when the level drops below a threshold. Input Description Default battery_sensor Battery level sensor entity to monitor Required battery_threshold Battery percentage trigger threshold 20% notify_service Notification service (e.g., notify.mobile_app ) Empty (uses persistent notification) notification_title Title for the notification \"ZigSight: Low Battery Alert\" cooldown_hours Hours between repeated alerts 24 Example notification: Motion Sensor battery is low at 15%. Consider replacing the battery soon.","title":"Battery Drain Alert"},{"location":"automations/#reconnect-flap-alert","text":"Detects devices that reconnect too frequently, which may indicate interference or connectivity issues. Input Description Default device_availability Availability or connectivity entity Required reconnect_count_threshold Number of reconnects to trigger alert 5 time_window_minutes Time window for counting reconnects 60 notify_service Notification service Empty (uses persistent notification) notification_title Title for the notification \"ZigSight: Device Flapping Detected\" cooldown_hours Hours between repeated alerts 6 Example notification: Door Sensor has reconnected 7 times in the last 60 minutes. This may indicate interference or connectivity issues.","title":"Reconnect Flap Alert"},{"location":"automations/#daily-network-health-report","text":"Sends a scheduled summary of your Zigbee network health. Input Description Default report_time Time to send the daily report 09:00:00 low_battery_threshold Battery level for flagging devices 30% offline_hours_threshold Hours offline to flag device 24 notify_service Notification service Empty (uses persistent notification) notification_title Title for the report \"ZigSight: Daily Network Health Report\" include_healthy_summary Include count of healthy devices true weekdays_only Only send on weekdays false Example report: \ud83d\udcca Network Health Report for 2024-01-15 **Overview:** \u2022 Total monitored devices: 25 \u2022 Healthy devices: 23 \u2022 Devices needing attention: 2 \u26a0\ufe0f **Low Battery Devices (< 30%):** \u2022 Motion Sensor Hallway \u2022 Contact Sensor Garage \ud83d\udca1 Tip: Consider replacing batteries in flagged devices soon.","title":"Daily Network Health Report"},{"location":"automations/#notification-services","text":"The blueprints support any Home Assistant notification service. Common options: Service Description notify.mobile_app_<device> Push notification to mobile app notify.persistent_notification Home Assistant UI notification notify.telegram Telegram bot notification notify.pushover Pushover notification notify.slack Slack channel notification Leave the notify_service input empty to use persistent notifications (visible in the Home Assistant UI sidebar).","title":"Notification Services"},{"location":"automations/#customization-tips","text":"","title":"Customization Tips"},{"location":"automations/#multiple-devices","text":"Create multiple automations from the same blueprint for different devices: # Kitchen motion sensor - id: battery_alert_kitchen use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.kitchen_motion_battery battery_threshold: 15 # Bedroom motion sensor - id: battery_alert_bedroom use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.bedroom_motion_battery battery_threshold: 20","title":"Multiple Devices"},{"location":"automations/#critical-vs-non-critical-devices","text":"Use different thresholds and notification services for critical devices: # Critical: Front door lock (immediate alert) - id: battery_critical_front_lock use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.front_door_lock_battery battery_threshold: 30 notify_service: notify.mobile_app_phone cooldown_hours: 12 # Non-critical: Outdoor temp sensor (weekly check) - id: battery_outdoor_temp use_blueprint: path: zigsight/battery_drain.yaml input: battery_sensor: sensor.outdoor_temp_battery battery_threshold: 10 cooldown_hours: 168","title":"Critical vs Non-Critical Devices"},{"location":"automations/#combining-with-other-automations","text":"Use blueprint automations as triggers for more complex workflows: automation: - alias: \"Critical Battery - Turn on Warning Light\" trigger: - platform: persistent_notification notification_id: zigsight_battery_* action: - service: light.turn_on target: entity_id: light.warning_indicator data: color_name: red","title":"Combining with Other Automations"},{"location":"automations/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"automations/#blueprint-not-appearing","text":"Verify the file is in the correct location ( blueprints/automation/zigsight/ ) Check for YAML syntax errors in the file Reload automations or restart Home Assistant","title":"Blueprint Not Appearing"},{"location":"automations/#notifications-not-sending","text":"Verify your notification service is correctly configured Check the notification service name matches exactly Review Home Assistant logs for errors","title":"Notifications Not Sending"},{"location":"automations/#too-manytoo-few-alerts","text":"Adjust the threshold and cooldown values: - Increase cooldown_hours to reduce alert frequency - Adjust battery_threshold to match your preferences - For reconnect alerts, increase reconnect_count_threshold or time_window_minutes","title":"Too Many/Too Few Alerts"},{"location":"automations/#see-also","text":"Getting Started - ZigSight installation and setup UI Documentation - Dashboard cards and visualization Developer README - Contributing to ZigSight","title":"See Also"},{"location":"faq/","text":"Frequently Asked Questions \u00b6 This page answers common questions about ZigSight. General \u00b6 What is ZigSight? \u00b6 ZigSight is a Home Assistant custom component that provides diagnostics and optimization tools for Zigbee networks. It helps you monitor device health, analyze network performance, and optimize your Zigbee channel selection. Which Zigbee integrations does ZigSight support? \u00b6 ZigSight currently supports: Zigbee2MQTT - MQTT-based Zigbee bridge ZHA - Zigbee Home Automation (native Home Assistant integration) deCONZ support is planned for a future release. Is ZigSight available through HACS? \u00b6 ZigSight can be installed as a custom repository through HACS. Add https://github.com/mmornati/zigsight as a custom repository in HACS. Installation \u00b6 How do I install ZigSight? \u00b6 See the Getting Started guide for detailed installation instructions. In brief: Copy custom_components/zigsight/ to your Home Assistant custom_components/ directory Restart Home Assistant Add the integration via Settings > Devices & Services Does ZigSight require MQTT? \u00b6 MQTT is required only if you use Zigbee2MQTT as your Zigbee coordinator. For ZHA, MQTT is not needed. If you're using Home Assistant's built-in MQTT integration, you can leave the MQTT Broker setting as localhost and ZigSight will use it automatically. What are the system requirements? \u00b6 Home Assistant 2025.10.0 or later Python 3.11 or later One of the supported Zigbee integrations configured Analytics \u00b6 How is the health score calculated? \u00b6 The health score (0-100) is computed from four weighted factors: Link Quality (30%) : Signal strength normalized from 0-255 to 0-100 Battery (20%) : Current battery level percentage Reconnect Rate (30%) : Inverted reconnect rate (lower is better) Connectivity (20%) : Based on how recently the device was seen See the Analytics documentation for detailed algorithm explanations. Why does my device show \"Unknown\" for metrics? \u00b6 This typically happens when: The device hasn't been seen recently There isn't enough historical data to compute metrics The device doesn't report the required attributes (e.g., battery level) Wait for more data to accumulate, usually 24-48 hours after installation. Can I customize the health score weights? \u00b6 Currently, the weights are fixed in code. Configurable weights may be added in a future release. What is a normal reconnect rate? \u00b6 Excellent : < 0.5 events/hour Good : 0.5 - 2 events/hour Fair : 2 - 5 events/hour Poor : > 5 events/hour High reconnect rates may indicate interference, weak signal, or device issues. Wi-Fi Recommendations \u00b6 How do I get a channel recommendation? \u00b6 Use the zigsight.recommend_channel service with one of three modes: Manual : Upload Wi-Fi scan data you've collected Router API : Query your router directly (limited router support) Host Scan : Scan using your Home Assistant host's Wi-Fi adapter See Wi-Fi Recommendation for detailed instructions. Which Zigbee channels should I use? \u00b6 ZigSight recommends from channels 11, 15, 20, and 25 because they provide the best spacing from common Wi-Fi channels (1, 6, 11). How often should I check for interference? \u00b6 We recommend running a Wi-Fi scan periodically, especially if: You notice increased device disconnections Your neighbors have set up new Wi-Fi networks You've changed your own Wi-Fi configuration Is changing the Zigbee channel safe? \u00b6 Changing channels requires all devices to rejoin the network. Most devices will rejoin automatically within 10-15 minutes, but some battery devices may take longer. Always: Backup your Zigbee network configuration first Schedule the change during a low-activity period Monitor devices for successful rejoining UI and Visualization \u00b6 How do I add the topology card? \u00b6 Register the card as a Lovelace resource (see UI documentation ) Add type: custom:zigsight-topology-card to your dashboard The topology card shows \"No data\" - what's wrong? \u00b6 Check that: ZigSight integration is properly configured and running Your Zigbee coordinator is connected and responding The API endpoint /api/zigsight/topology returns data (test in browser) Can I see a graph visualization of my network? \u00b6 The current version shows devices as cards. A graph/tree visualization using D3.js or vis-network is planned for a future release. Automations \u00b6 How do I import the blueprints? \u00b6 Go to Settings \u2192 Automations & Scenes \u2192 Blueprints Click Import Blueprint Paste the blueprint URL from the Automations documentation Can I customize the blueprint thresholds? \u00b6 Yes! When you create an automation from a blueprint, you can customize all the input values including thresholds, notification services, and cooldown periods. How do I get notifications on my phone? \u00b6 Set the notify_service input to your mobile app notification service, e.g., notify.mobile_app_your_phone . Make sure the Home Assistant Companion app is installed and configured. Troubleshooting \u00b6 ZigSight isn't detecting my devices \u00b6 Check that: Your Zigbee coordinator (Zigbee2MQTT or ZHA) is working correctly Devices are visible in your coordinator's interface The ZigSight integration is configured for the correct coordinator type I'm getting errors in the Home Assistant logs \u00b6 Enable debug logging for more details: logger: default: info logs: custom_components.zigsight: debug Then check the logs for specific error messages. Metrics aren't updating \u00b6 Metrics are computed based on device history. If metrics aren't updating: Verify devices are actively sending data Check coordinator connectivity Restart the ZigSight integration How do I report a bug? \u00b6 Open an issue on GitHub with: Home Assistant version ZigSight version Zigbee coordinator type and version Steps to reproduce the issue Relevant log entries Contributing \u00b6 How can I contribute to ZigSight? \u00b6 See the Developer README for development setup and contribution guidelines. We welcome: Bug reports and feature requests Documentation improvements Code contributions Where can I get help? \u00b6 Documentation : Start with this FAQ and the linked guides GitHub Issues : For bugs and feature requests GitHub Discussions : For general questions and community support","title":"FAQ"},{"location":"faq/#frequently-asked-questions","text":"This page answers common questions about ZigSight.","title":"Frequently Asked Questions"},{"location":"faq/#general","text":"","title":"General"},{"location":"faq/#what-is-zigsight","text":"ZigSight is a Home Assistant custom component that provides diagnostics and optimization tools for Zigbee networks. It helps you monitor device health, analyze network performance, and optimize your Zigbee channel selection.","title":"What is ZigSight?"},{"location":"faq/#which-zigbee-integrations-does-zigsight-support","text":"ZigSight currently supports: Zigbee2MQTT - MQTT-based Zigbee bridge ZHA - Zigbee Home Automation (native Home Assistant integration) deCONZ support is planned for a future release.","title":"Which Zigbee integrations does ZigSight support?"},{"location":"faq/#is-zigsight-available-through-hacs","text":"ZigSight can be installed as a custom repository through HACS. Add https://github.com/mmornati/zigsight as a custom repository in HACS.","title":"Is ZigSight available through HACS?"},{"location":"faq/#installation","text":"","title":"Installation"},{"location":"faq/#how-do-i-install-zigsight","text":"See the Getting Started guide for detailed installation instructions. In brief: Copy custom_components/zigsight/ to your Home Assistant custom_components/ directory Restart Home Assistant Add the integration via Settings > Devices & Services","title":"How do I install ZigSight?"},{"location":"faq/#does-zigsight-require-mqtt","text":"MQTT is required only if you use Zigbee2MQTT as your Zigbee coordinator. For ZHA, MQTT is not needed. If you're using Home Assistant's built-in MQTT integration, you can leave the MQTT Broker setting as localhost and ZigSight will use it automatically.","title":"Does ZigSight require MQTT?"},{"location":"faq/#what-are-the-system-requirements","text":"Home Assistant 2025.10.0 or later Python 3.11 or later One of the supported Zigbee integrations configured","title":"What are the system requirements?"},{"location":"faq/#analytics","text":"","title":"Analytics"},{"location":"faq/#how-is-the-health-score-calculated","text":"The health score (0-100) is computed from four weighted factors: Link Quality (30%) : Signal strength normalized from 0-255 to 0-100 Battery (20%) : Current battery level percentage Reconnect Rate (30%) : Inverted reconnect rate (lower is better) Connectivity (20%) : Based on how recently the device was seen See the Analytics documentation for detailed algorithm explanations.","title":"How is the health score calculated?"},{"location":"faq/#why-does-my-device-show-unknown-for-metrics","text":"This typically happens when: The device hasn't been seen recently There isn't enough historical data to compute metrics The device doesn't report the required attributes (e.g., battery level) Wait for more data to accumulate, usually 24-48 hours after installation.","title":"Why does my device show \"Unknown\" for metrics?"},{"location":"faq/#can-i-customize-the-health-score-weights","text":"Currently, the weights are fixed in code. Configurable weights may be added in a future release.","title":"Can I customize the health score weights?"},{"location":"faq/#what-is-a-normal-reconnect-rate","text":"Excellent : < 0.5 events/hour Good : 0.5 - 2 events/hour Fair : 2 - 5 events/hour Poor : > 5 events/hour High reconnect rates may indicate interference, weak signal, or device issues.","title":"What is a normal reconnect rate?"},{"location":"faq/#wi-fi-recommendations","text":"","title":"Wi-Fi Recommendations"},{"location":"faq/#how-do-i-get-a-channel-recommendation","text":"Use the zigsight.recommend_channel service with one of three modes: Manual : Upload Wi-Fi scan data you've collected Router API : Query your router directly (limited router support) Host Scan : Scan using your Home Assistant host's Wi-Fi adapter See Wi-Fi Recommendation for detailed instructions.","title":"How do I get a channel recommendation?"},{"location":"faq/#which-zigbee-channels-should-i-use","text":"ZigSight recommends from channels 11, 15, 20, and 25 because they provide the best spacing from common Wi-Fi channels (1, 6, 11).","title":"Which Zigbee channels should I use?"},{"location":"faq/#how-often-should-i-check-for-interference","text":"We recommend running a Wi-Fi scan periodically, especially if: You notice increased device disconnections Your neighbors have set up new Wi-Fi networks You've changed your own Wi-Fi configuration","title":"How often should I check for interference?"},{"location":"faq/#is-changing-the-zigbee-channel-safe","text":"Changing channels requires all devices to rejoin the network. Most devices will rejoin automatically within 10-15 minutes, but some battery devices may take longer. Always: Backup your Zigbee network configuration first Schedule the change during a low-activity period Monitor devices for successful rejoining","title":"Is changing the Zigbee channel safe?"},{"location":"faq/#ui-and-visualization","text":"","title":"UI and Visualization"},{"location":"faq/#how-do-i-add-the-topology-card","text":"Register the card as a Lovelace resource (see UI documentation ) Add type: custom:zigsight-topology-card to your dashboard","title":"How do I add the topology card?"},{"location":"faq/#the-topology-card-shows-no-data-whats-wrong","text":"Check that: ZigSight integration is properly configured and running Your Zigbee coordinator is connected and responding The API endpoint /api/zigsight/topology returns data (test in browser)","title":"The topology card shows \"No data\" - what's wrong?"},{"location":"faq/#can-i-see-a-graph-visualization-of-my-network","text":"The current version shows devices as cards. A graph/tree visualization using D3.js or vis-network is planned for a future release.","title":"Can I see a graph visualization of my network?"},{"location":"faq/#automations","text":"","title":"Automations"},{"location":"faq/#how-do-i-import-the-blueprints","text":"Go to Settings \u2192 Automations & Scenes \u2192 Blueprints Click Import Blueprint Paste the blueprint URL from the Automations documentation","title":"How do I import the blueprints?"},{"location":"faq/#can-i-customize-the-blueprint-thresholds","text":"Yes! When you create an automation from a blueprint, you can customize all the input values including thresholds, notification services, and cooldown periods.","title":"Can I customize the blueprint thresholds?"},{"location":"faq/#how-do-i-get-notifications-on-my-phone","text":"Set the notify_service input to your mobile app notification service, e.g., notify.mobile_app_your_phone . Make sure the Home Assistant Companion app is installed and configured.","title":"How do I get notifications on my phone?"},{"location":"faq/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"faq/#zigsight-isnt-detecting-my-devices","text":"Check that: Your Zigbee coordinator (Zigbee2MQTT or ZHA) is working correctly Devices are visible in your coordinator's interface The ZigSight integration is configured for the correct coordinator type","title":"ZigSight isn't detecting my devices"},{"location":"faq/#im-getting-errors-in-the-home-assistant-logs","text":"Enable debug logging for more details: logger: default: info logs: custom_components.zigsight: debug Then check the logs for specific error messages.","title":"I'm getting errors in the Home Assistant logs"},{"location":"faq/#metrics-arent-updating","text":"Metrics are computed based on device history. If metrics aren't updating: Verify devices are actively sending data Check coordinator connectivity Restart the ZigSight integration","title":"Metrics aren't updating"},{"location":"faq/#how-do-i-report-a-bug","text":"Open an issue on GitHub with: Home Assistant version ZigSight version Zigbee coordinator type and version Steps to reproduce the issue Relevant log entries","title":"How do I report a bug?"},{"location":"faq/#contributing","text":"","title":"Contributing"},{"location":"faq/#how-can-i-contribute-to-zigsight","text":"See the Developer README for development setup and contribution guidelines. We welcome: Bug reports and feature requests Documentation improvements Code contributions","title":"How can I contribute to ZigSight?"},{"location":"faq/#where-can-i-get-help","text":"Documentation : Start with this FAQ and the linked guides GitHub Issues : For bugs and feature requests GitHub Discussions : For general questions and community support","title":"Where can I get help?"},{"location":"getting_started/","text":"Getting Started with ZigSight \u00b6 ZigSight is a Home Assistant custom component that provides diagnostics and optimization tools for Zigbee networks. Installation \u00b6 To install ZigSight, copy the custom_components/zigsight/ directory into your Home Assistant custom_components/ folder. Navigate to your Home Assistant configuration directory (usually .homeassistant/ or config/ ) Create a custom_components/ directory if it doesn't exist Copy the entire zigsight/ folder into custom_components/ Restart Home Assistant Go to Settings > Devices & Services and click Add Integration Search for \"ZigSight\" and follow the setup wizard Your directory structure should look like this: config/ \u251c\u2500\u2500 configuration.yaml \u2514\u2500\u2500 custom_components/ \u2514\u2500\u2500 zigsight/ \u251c\u2500\u2500 __init__.py \u251c\u2500\u2500 manifest.json \u251c\u2500\u2500 config_flow.py \u2514\u2500\u2500 ... Configuration \u00b6 After installation, ZigSight can be configured through the Home Assistant UI via Settings > Devices & Services . Step 1: Select Integration Type \u00b6 When adding the integration, you'll first choose your Zigbee coordinator: Zigbee2MQTT : If you use Zigbee2MQTT as your Zigbee bridge ZHA : If you use Home Assistant's native ZHA integration Step 2: Configure Integration-Specific Settings \u00b6 For Zigbee2MQTT: - MQTT Broker : Hostname or IP of your MQTT broker (leave as localhost to use Home Assistant's MQTT integration) - MQTT Port : Port number (default: 1883) - MQTT Username/Password : Optional, if your broker requires authentication - MQTT Topic Prefix : Base topic for Zigbee2MQTT (default: zigbee2mqtt ) For ZHA: - No additional configuration needed - ZigSight automatically detects your ZHA devices Step 3: Configure Analytics Settings (Optional) \u00b6 Customize the analytics thresholds: Battery Drain Threshold : Minimum drain rate (%/hour) to trigger warning (default: 10.0) Reconnect Rate Threshold : Maximum reconnect rate (events/hour) before warning (default: 5.0) Reconnect Rate Window : Time window in hours for calculations (default: 24) Reconnect Threshold : Number of reconnections to track (default: 5) Data Retention : Number of days to keep device history (default: 30) What's Next? \u00b6 After configuration, ZigSight will: Discover your devices - Automatically detect all Zigbee devices from your coordinator Create sensors - Generate health scores, reconnect rates, and battery trends for each device Monitor your network - Track device connectivity and battery health Provide recommendations - Use the Wi-Fi channel recommendation service to optimize your Zigbee channel See the Integrations guides for detailed setup instructions for your specific coordinator.","title":"Getting Started"},{"location":"getting_started/#getting-started-with-zigsight","text":"ZigSight is a Home Assistant custom component that provides diagnostics and optimization tools for Zigbee networks.","title":"Getting Started with ZigSight"},{"location":"getting_started/#installation","text":"To install ZigSight, copy the custom_components/zigsight/ directory into your Home Assistant custom_components/ folder. Navigate to your Home Assistant configuration directory (usually .homeassistant/ or config/ ) Create a custom_components/ directory if it doesn't exist Copy the entire zigsight/ folder into custom_components/ Restart Home Assistant Go to Settings > Devices & Services and click Add Integration Search for \"ZigSight\" and follow the setup wizard Your directory structure should look like this: config/ \u251c\u2500\u2500 configuration.yaml \u2514\u2500\u2500 custom_components/ \u2514\u2500\u2500 zigsight/ \u251c\u2500\u2500 __init__.py \u251c\u2500\u2500 manifest.json \u251c\u2500\u2500 config_flow.py \u2514\u2500\u2500 ...","title":"Installation"},{"location":"getting_started/#configuration","text":"After installation, ZigSight can be configured through the Home Assistant UI via Settings > Devices & Services .","title":"Configuration"},{"location":"getting_started/#step-1-select-integration-type","text":"When adding the integration, you'll first choose your Zigbee coordinator: Zigbee2MQTT : If you use Zigbee2MQTT as your Zigbee bridge ZHA : If you use Home Assistant's native ZHA integration","title":"Step 1: Select Integration Type"},{"location":"getting_started/#step-2-configure-integration-specific-settings","text":"For Zigbee2MQTT: - MQTT Broker : Hostname or IP of your MQTT broker (leave as localhost to use Home Assistant's MQTT integration) - MQTT Port : Port number (default: 1883) - MQTT Username/Password : Optional, if your broker requires authentication - MQTT Topic Prefix : Base topic for Zigbee2MQTT (default: zigbee2mqtt ) For ZHA: - No additional configuration needed - ZigSight automatically detects your ZHA devices","title":"Step 2: Configure Integration-Specific Settings"},{"location":"getting_started/#step-3-configure-analytics-settings-optional","text":"Customize the analytics thresholds: Battery Drain Threshold : Minimum drain rate (%/hour) to trigger warning (default: 10.0) Reconnect Rate Threshold : Maximum reconnect rate (events/hour) before warning (default: 5.0) Reconnect Rate Window : Time window in hours for calculations (default: 24) Reconnect Threshold : Number of reconnections to track (default: 5) Data Retention : Number of days to keep device history (default: 30)","title":"Step 3: Configure Analytics Settings (Optional)"},{"location":"getting_started/#whats-next","text":"After configuration, ZigSight will: Discover your devices - Automatically detect all Zigbee devices from your coordinator Create sensors - Generate health scores, reconnect rates, and battery trends for each device Monitor your network - Track device connectivity and battery health Provide recommendations - Use the Wi-Fi channel recommendation service to optimize your Zigbee channel See the Integrations guides for detailed setup instructions for your specific coordinator.","title":"What's Next?"},{"location":"ui/","text":"ZigSight UI - Network Topology Visualization \u00b6 This document describes how to use the ZigSight Network Topology card to visualize your Zigbee network. Overview \u00b6 The ZigSight Network Topology card provides an interactive visualization of your Zigbee network, showing: Coordinator : The Zigbee coordinator (typically your Zigbee2MQTT bridge) Routers : Devices that can route messages (typically powered devices) End Devices : Battery-powered devices that don't route messages Link Quality : Visual indicators for signal strength between devices Device Health : Health scores and warnings for problematic devices Installation \u00b6 Step 1: Add the Custom Card Resource \u00b6 The topology card is automatically included with ZigSight. To use it, you need to register it as a Lovelace resource. Option A: Using the UI (Recommended) \u00b6 Navigate to Settings \u2192 Dashboards \u2192 Resources (click the three-dot menu in the top right) Click Add Resource Enter the URL: /local/community/zigsight/topology-card.js Set Resource type to JavaScript Module Click Create Option B: Using YAML Configuration \u00b6 Add the following to your configuration.yaml : lovelace: mode: yaml resources: - url: /local/community/zigsight/topology-card.js type: module Note : You'll need to copy the topology-card.js file from custom_components/zigsight/www/ to your www/community/zigsight/ directory: mkdir -p config/www/community/zigsight cp custom_components/zigsight/www/topology-card.js config/www/community/zigsight/ Step 2: Add the Card to Your Dashboard \u00b6 Using the UI \u00b6 Open the dashboard where you want to add the card Click Edit Dashboard (three-dot menu \u2192 Edit Dashboard ) Click Add Card Search for \"ZigSight Network Topology\" Click to add the card Using YAML \u00b6 Add the following to your dashboard configuration: type: custom:zigsight-topology-card title: Zigbee Network Topology Configuration Options \u00b6 The topology card supports the following configuration options: type: custom:zigsight-topology-card title: My Zigbee Network # Optional: Custom title (default: \"Zigbee Network Topology\") Available Options \u00b6 Option Type Default Description title string \"Zigbee Network Topology\" Card title displayed in the header Understanding the Visualization \u00b6 Network Statistics \u00b6 At the top of the card, you'll see statistics about your network: Total Devices : Total number of devices in your network Coordinator : Number of coordinators (typically 1) Routers : Number of router devices End Devices : Number of battery-powered end devices Device Cards \u00b6 Each device is displayed as a card with the following information: Device Name : Friendly name of the device Device Type : Coordinator, Router, or End Device Link Quality (LQI) : Signal strength indicator (0-255) \ud83d\udfe2 Green (200-255): Excellent \ud83d\udfe1 Yellow-Green (150-199): Good \ud83d\udfe0 Orange (100-149): Fair \ud83d\udd34 Red (0-99): Poor Battery : Battery percentage (if applicable) Health Score : Overall device health (0-100) Color Legend \u00b6 Blue border : Coordinator Green border : Router Orange border : End Device Red border : Device with warnings (connectivity or battery issues) Device Details Dialog \u00b6 Click on any device card to open a detailed dialog showing: Device type and friendly name Link quality Battery level (if applicable) Health score Reconnect rate Last seen timestamp Active warnings API Endpoint \u00b6 The card fetches topology data from the following API endpoint: GET /api/zigsight/topology This endpoint returns JSON data with the following structure: { \"nodes\": [ { \"id\": \"device_id\", \"label\": \"Friendly Name\", \"type\": \"coordinator|router|end_device\", \"link_quality\": 255, \"battery\": 80, \"last_seen\": \"2024-01-01T12:00:00Z\", \"health_score\": 85.0, \"analytics\": { \"reconnect_rate\": 0.5, \"battery_trend\": -0.1, \"battery_drain_warning\": false, \"connectivity_warning\": false } } ], \"edges\": [ { \"from\": \"parent_device_id\", \"to\": \"child_device_id\", \"link_quality\": 150 } ], \"device_count\": 10, \"coordinator_count\": 1, \"router_count\": 3, \"end_device_count\": 6 } Troubleshooting \u00b6 Card Not Loading \u00b6 Check Resource Registration : Ensure the card is properly registered in Lovelace resources Check File Location : Verify topology-card.js is in the correct location Clear Browser Cache : Try clearing your browser cache or opening in incognito mode Check Browser Console : Open browser developer tools (F12) and check for JavaScript errors No Data Displayed \u00b6 Check ZigSight Integration : Ensure ZigSight integration is properly configured Check MQTT Connection : Verify Zigbee2MQTT is running and connected Check API Endpoint : Try accessing /api/zigsight/topology directly in your browser Check Logs : Review Home Assistant logs for any ZigSight errors Incorrect Device Information \u00b6 Refresh the Card : Click the \"Refresh\" button in the card header Restart Integration : Restart the ZigSight integration from Settings \u2192 Devices & Services Check Zigbee2MQTT : Ensure your Zigbee2MQTT instance is providing correct device data Advanced Usage \u00b6 Multiple Networks \u00b6 If you have multiple Zigbee networks (multiple coordinators), the API endpoint will return data from the first configured ZigSight instance. To visualize multiple networks, you can: Add multiple instances of the card Configure each ZigSight integration with a unique identifier (Future feature) Use a coordinator_id configuration option to specify which network to display Custom Styling \u00b6 The card uses Home Assistant's theme variables for styling. You can customize the appearance by: Using a custom Home Assistant theme Adding custom CSS using card-mod (community plugin) Example with card-mod : type: custom:zigsight-topology-card title: My Network card_mod: style: | .card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); } Examples \u00b6 Basic Configuration \u00b6 type: custom:zigsight-topology-card Custom Title \u00b6 type: custom:zigsight-topology-card title: Living Room Zigbee Network In a Vertical Stack \u00b6 type: vertical-stack cards: - type: markdown content: | ## Network Overview Monitor your Zigbee network health and topology. - type: custom:zigsight-topology-card title: Zigbee Network - type: entities entities: - sensor.zigsight_network_health - sensor.zigsight_device_count Integration with Other Cards \u00b6 The topology card works well alongside other ZigSight sensors and cards: type: horizontal-stack cards: - type: custom:zigsight-topology-card title: Network Topology - type: vertical-stack cards: - type: gauge entity: sensor.zigsight_network_health name: Network Health min: 0 max: 100 - type: entities entities: - sensor.zigsight_coordinator - sensor.zigsight_routers - sensor.zigsight_end_devices Frequently Asked Questions \u00b6 Q: Can I see the actual network graph/tree visualization? \u00b6 A: The current version displays devices as cards for better readability on mobile devices. A future version may include an interactive graph visualization using libraries like vis-network or D3.js. Q: Can I filter devices by type? \u00b6 A: This feature is planned for a future release. For now, device cards are color-coded by type. Q: How often is the topology data refreshed? \u00b6 A: The topology data is loaded when the card is first displayed. Click the \"Refresh\" button to manually update. Automatic refresh every 60 seconds can be added if needed. Q: Can I export the topology data? \u00b6 A: You can access the raw JSON data by visiting /api/zigsight/topology in your browser. Copy and save the JSON response for analysis or backup. See Also \u00b6 Getting Started Guide Analytics Documentation Wi-Fi Recommendations Developer README","title":"UI"},{"location":"ui/#zigsight-ui-network-topology-visualization","text":"This document describes how to use the ZigSight Network Topology card to visualize your Zigbee network.","title":"ZigSight UI - Network Topology Visualization"},{"location":"ui/#overview","text":"The ZigSight Network Topology card provides an interactive visualization of your Zigbee network, showing: Coordinator : The Zigbee coordinator (typically your Zigbee2MQTT bridge) Routers : Devices that can route messages (typically powered devices) End Devices : Battery-powered devices that don't route messages Link Quality : Visual indicators for signal strength between devices Device Health : Health scores and warnings for problematic devices","title":"Overview"},{"location":"ui/#installation","text":"","title":"Installation"},{"location":"ui/#step-1-add-the-custom-card-resource","text":"The topology card is automatically included with ZigSight. To use it, you need to register it as a Lovelace resource.","title":"Step 1: Add the Custom Card Resource"},{"location":"ui/#option-a-using-the-ui-recommended","text":"Navigate to Settings \u2192 Dashboards \u2192 Resources (click the three-dot menu in the top right) Click Add Resource Enter the URL: /local/community/zigsight/topology-card.js Set Resource type to JavaScript Module Click Create","title":"Option A: Using the UI (Recommended)"},{"location":"ui/#option-b-using-yaml-configuration","text":"Add the following to your configuration.yaml : lovelace: mode: yaml resources: - url: /local/community/zigsight/topology-card.js type: module Note : You'll need to copy the topology-card.js file from custom_components/zigsight/www/ to your www/community/zigsight/ directory: mkdir -p config/www/community/zigsight cp custom_components/zigsight/www/topology-card.js config/www/community/zigsight/","title":"Option B: Using YAML Configuration"},{"location":"ui/#step-2-add-the-card-to-your-dashboard","text":"","title":"Step 2: Add the Card to Your Dashboard"},{"location":"ui/#using-the-ui","text":"Open the dashboard where you want to add the card Click Edit Dashboard (three-dot menu \u2192 Edit Dashboard ) Click Add Card Search for \"ZigSight Network Topology\" Click to add the card","title":"Using the UI"},{"location":"ui/#using-yaml","text":"Add the following to your dashboard configuration: type: custom:zigsight-topology-card title: Zigbee Network Topology","title":"Using YAML"},{"location":"ui/#configuration-options","text":"The topology card supports the following configuration options: type: custom:zigsight-topology-card title: My Zigbee Network # Optional: Custom title (default: \"Zigbee Network Topology\")","title":"Configuration Options"},{"location":"ui/#available-options","text":"Option Type Default Description title string \"Zigbee Network Topology\" Card title displayed in the header","title":"Available Options"},{"location":"ui/#understanding-the-visualization","text":"","title":"Understanding the Visualization"},{"location":"ui/#network-statistics","text":"At the top of the card, you'll see statistics about your network: Total Devices : Total number of devices in your network Coordinator : Number of coordinators (typically 1) Routers : Number of router devices End Devices : Number of battery-powered end devices","title":"Network Statistics"},{"location":"ui/#device-cards","text":"Each device is displayed as a card with the following information: Device Name : Friendly name of the device Device Type : Coordinator, Router, or End Device Link Quality (LQI) : Signal strength indicator (0-255) \ud83d\udfe2 Green (200-255): Excellent \ud83d\udfe1 Yellow-Green (150-199): Good \ud83d\udfe0 Orange (100-149): Fair \ud83d\udd34 Red (0-99): Poor Battery : Battery percentage (if applicable) Health Score : Overall device health (0-100)","title":"Device Cards"},{"location":"ui/#color-legend","text":"Blue border : Coordinator Green border : Router Orange border : End Device Red border : Device with warnings (connectivity or battery issues)","title":"Color Legend"},{"location":"ui/#device-details-dialog","text":"Click on any device card to open a detailed dialog showing: Device type and friendly name Link quality Battery level (if applicable) Health score Reconnect rate Last seen timestamp Active warnings","title":"Device Details Dialog"},{"location":"ui/#api-endpoint","text":"The card fetches topology data from the following API endpoint: GET /api/zigsight/topology This endpoint returns JSON data with the following structure: { \"nodes\": [ { \"id\": \"device_id\", \"label\": \"Friendly Name\", \"type\": \"coordinator|router|end_device\", \"link_quality\": 255, \"battery\": 80, \"last_seen\": \"2024-01-01T12:00:00Z\", \"health_score\": 85.0, \"analytics\": { \"reconnect_rate\": 0.5, \"battery_trend\": -0.1, \"battery_drain_warning\": false, \"connectivity_warning\": false } } ], \"edges\": [ { \"from\": \"parent_device_id\", \"to\": \"child_device_id\", \"link_quality\": 150 } ], \"device_count\": 10, \"coordinator_count\": 1, \"router_count\": 3, \"end_device_count\": 6 }","title":"API Endpoint"},{"location":"ui/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"ui/#card-not-loading","text":"Check Resource Registration : Ensure the card is properly registered in Lovelace resources Check File Location : Verify topology-card.js is in the correct location Clear Browser Cache : Try clearing your browser cache or opening in incognito mode Check Browser Console : Open browser developer tools (F12) and check for JavaScript errors","title":"Card Not Loading"},{"location":"ui/#no-data-displayed","text":"Check ZigSight Integration : Ensure ZigSight integration is properly configured Check MQTT Connection : Verify Zigbee2MQTT is running and connected Check API Endpoint : Try accessing /api/zigsight/topology directly in your browser Check Logs : Review Home Assistant logs for any ZigSight errors","title":"No Data Displayed"},{"location":"ui/#incorrect-device-information","text":"Refresh the Card : Click the \"Refresh\" button in the card header Restart Integration : Restart the ZigSight integration from Settings \u2192 Devices & Services Check Zigbee2MQTT : Ensure your Zigbee2MQTT instance is providing correct device data","title":"Incorrect Device Information"},{"location":"ui/#advanced-usage","text":"","title":"Advanced Usage"},{"location":"ui/#multiple-networks","text":"If you have multiple Zigbee networks (multiple coordinators), the API endpoint will return data from the first configured ZigSight instance. To visualize multiple networks, you can: Add multiple instances of the card Configure each ZigSight integration with a unique identifier (Future feature) Use a coordinator_id configuration option to specify which network to display","title":"Multiple Networks"},{"location":"ui/#custom-styling","text":"The card uses Home Assistant's theme variables for styling. You can customize the appearance by: Using a custom Home Assistant theme Adding custom CSS using card-mod (community plugin) Example with card-mod : type: custom:zigsight-topology-card title: My Network card_mod: style: | .card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }","title":"Custom Styling"},{"location":"ui/#examples","text":"","title":"Examples"},{"location":"ui/#basic-configuration","text":"type: custom:zigsight-topology-card","title":"Basic Configuration"},{"location":"ui/#custom-title","text":"type: custom:zigsight-topology-card title: Living Room Zigbee Network","title":"Custom Title"},{"location":"ui/#in-a-vertical-stack","text":"type: vertical-stack cards: - type: markdown content: | ## Network Overview Monitor your Zigbee network health and topology. - type: custom:zigsight-topology-card title: Zigbee Network - type: entities entities: - sensor.zigsight_network_health - sensor.zigsight_device_count","title":"In a Vertical Stack"},{"location":"ui/#integration-with-other-cards","text":"The topology card works well alongside other ZigSight sensors and cards: type: horizontal-stack cards: - type: custom:zigsight-topology-card title: Network Topology - type: vertical-stack cards: - type: gauge entity: sensor.zigsight_network_health name: Network Health min: 0 max: 100 - type: entities entities: - sensor.zigsight_coordinator - sensor.zigsight_routers - sensor.zigsight_end_devices","title":"Integration with Other Cards"},{"location":"ui/#frequently-asked-questions","text":"","title":"Frequently Asked Questions"},{"location":"ui/#q-can-i-see-the-actual-network-graphtree-visualization","text":"A: The current version displays devices as cards for better readability on mobile devices. A future version may include an interactive graph visualization using libraries like vis-network or D3.js.","title":"Q: Can I see the actual network graph/tree visualization?"},{"location":"ui/#q-can-i-filter-devices-by-type","text":"A: This feature is planned for a future release. For now, device cards are color-coded by type.","title":"Q: Can I filter devices by type?"},{"location":"ui/#q-how-often-is-the-topology-data-refreshed","text":"A: The topology data is loaded when the card is first displayed. Click the \"Refresh\" button to manually update. Automatic refresh every 60 seconds can be added if needed.","title":"Q: How often is the topology data refreshed?"},{"location":"ui/#q-can-i-export-the-topology-data","text":"A: You can access the raw JSON data by visiting /api/zigsight/topology in your browser. Copy and save the JSON response for analysis or backup.","title":"Q: Can I export the topology data?"},{"location":"ui/#see-also","text":"Getting Started Guide Analytics Documentation Wi-Fi Recommendations Developer README","title":"See Also"},{"location":"wifi_recommendation/","text":"Wi-Fi Interference Analysis and Zigbee Channel Recommendation \u00b6 This guide explains how to use ZigSight's Wi-Fi interference analysis to optimize your Zigbee network by selecting the best channel. Overview \u00b6 Zigbee and Wi-Fi both operate in the 2.4 GHz spectrum, which can lead to interference and degraded performance. ZigSight analyzes Wi-Fi access points in your environment and recommends the optimal Zigbee channel (11, 15, 20, or 25) to minimize interference. Understanding Channel Overlap \u00b6 Wi-Fi Channels \u00b6 Wi-Fi channels in the 2.4 GHz band use approximately 22 MHz of bandwidth each. While common channels are 1, 6, and 11, any channels from 1-13 (or 1-14 in some regions) may be in use. Zigbee Channels \u00b6 Zigbee uses much narrower channels (~2 MHz) numbered 11-26 in the 2.4 GHz band. However, only channels 11, 15, 20, and 25 are recommended because they provide optimal spacing from common Wi-Fi channels. Overlap Mapping \u00b6 Zigbee Channel 11 (~2405 MHz): Overlaps with Wi-Fi channels 1-2 Zigbee Channel 15 (~2425 MHz): Overlaps with Wi-Fi channels 2-4 Zigbee Channel 20 (~2450 MHz): Overlaps with Wi-Fi channels 6-8 Zigbee Channel 25 (~2475 MHz): Overlaps with Wi-Fi channels 11-13 Using the Service \u00b6 Method 1: Manual Upload (Recommended for Most Users) \u00b6 This is the easiest method. Export Wi-Fi scan data from your router, then upload it to ZigSight. Step 1: Obtain Wi-Fi Scan Data \u00b6 See the router-specific guides below for how to export Wi-Fi scan data. Step 2: Call the Service \u00b6 In Home Assistant, go to Developer Tools > Services Select service: zigsight.recommend_channel Set mode to manual Paste your Wi-Fi scan data in the wifi_scan_data field Example service call: service: zigsight.recommend_channel data: mode: manual wifi_scan_data: - channel: 1 rssi: -45 ssid: \"MyNetwork\" - channel: 6 rssi: -60 ssid: \"NeighborNetwork\" - channel: 11 rssi: -75 ssid: \"AnotherNetwork\" The service will log the recommendation and explanation to Home Assistant logs. You can also retrieve the last recommendation from hass.data[DOMAIN][\"last_recommendation\"] . Method 2: Router API Mode \u00b6 This mode directly queries your router's API for Wi-Fi scan data (when implemented for your router). Note: Router API support is currently a placeholder and requires router-specific implementation. For now, use manual mode. Example (future functionality): service: zigsight.recommend_channel data: mode: router_api router_type: unifi host: 192.168.1.1 username: admin password: your_password Method 3: Host Scan Mode \u00b6 This mode runs a Wi-Fi scan directly on your Home Assistant host using system tools (iwlist or nmcli). Requirements: - Home Assistant running on hardware with a Wi-Fi adapter - Appropriate permissions to run scanning commands - May require a privileged add-on configuration Example: service: zigsight.recommend_channel data: mode: host_scan interface: wlan0 # Optional, defaults to wlan0 Note: This mode may not work in Docker containers or supervised installations without additional configuration. Router-Specific Guides \u00b6 UniFi \u00b6 Log in to your UniFi controller Navigate to Insights > Wi-Fi View the RF Environment scan Export or note down: Channel numbers RSSI values (signal strength) SSIDs Format for ZigSight: [ {\"channel\": 1, \"rssi\": -45, \"ssid\": \"Network1\"}, {\"channel\": 6, \"rssi\": -60, \"ssid\": \"Network2\"} ] OpenWrt \u00b6 SSH into your OpenWrt router Run: iwinfo wlan0 scan Note the Channel and Signal values Format as JSON for ZigSight Fritz!Box \u00b6 Log in to Fritz!Box web interface Navigate to WLAN > Radio Channel View the channel usage graph Note which channels have active networks Estimate RSSI based on signal strength indicators Generic Router \u00b6 Most routers have a Wi-Fi analyzer or channel scanner: 1. Look for \"Wi-Fi Analyzer\", \"Channel Scanner\", or \"RF Environment\" in your router settings 2. Export or screenshot the scan results 3. Create a JSON list with channel and approximate RSSI values RSSI Guidelines: - Excellent signal: -30 to -50 dBm - Good signal: -50 to -65 dBm - Fair signal: -65 to -80 dBm - Weak signal: -80 to -90 dBm Understanding Results \u00b6 The service returns: - recommended_channel : The best Zigbee channel (11, 15, 20, or 25) - scores : Interference scores for all 4 channels (0 = best, 100 = worst) - explanation : Human-readable summary of the analysis Example result logged: INFO: Zigbee channel recommendation: Channel 15 (score: 12.3) INFO: Recommendation: Analyzed 8 Wi-Fi access points on channels: Ch1 (3 APs), Ch6 (2 APs), Ch11 (3 APs). Zigbee channel 15 has the lowest interference score (12.3/100). This channel has minimal Wi-Fi interference. Changing Your Zigbee Channel \u00b6 \u26a0\ufe0f IMPORTANT: Changing your Zigbee channel requires careful planning Before You Change \u00b6 Backup your Zigbee network configuration through your coordinator software (Zigbee2MQTT, ZHA, or deCONZ) Plan for downtime : All devices will temporarily disconnect Ensure all devices are powered : Battery devices should have fresh batteries Schedule the change : Pick a time when automation disruption is acceptable Migration Checklist \u00b6 [ ] Run Wi-Fi scan and get channel recommendation [ ] Backup Zigbee coordinator configuration [ ] Verify all devices are online and responsive [ ] Schedule migration during low-activity period [ ] Change coordinator channel in your Zigbee software [ ] Restart coordinator [ ] Wait 10-15 minutes for devices to rejoin [ ] Verify all devices are back online [ ] Test automations Zigbee2MQTT \u00b6 Stop Zigbee2MQTT Edit configuration.yaml : yaml advanced: channel: 15 # Your recommended channel Start Zigbee2MQTT Devices will automatically rejoin (may take 10-15 minutes) ZHA (Home Assistant) \u00b6 Go to Settings > Devices & Services > Zigbee Home Automation Click Configure Select Change channel Enter your recommended channel Confirm and wait for migration to complete deCONZ \u00b6 Open deCONZ GUI Go to Settings > Gateway Change the channel number Restart deCONZ Devices will rejoin automatically Troubleshooting \u00b6 No Recommendation Available \u00b6 Ensure Wi-Fi scan data is properly formatted Check Home Assistant logs for error messages Verify JSON syntax if using manual mode Devices Not Rejoining After Channel Change \u00b6 Wait at least 15-20 minutes for battery devices Power cycle mains-powered devices (routers help extend the network) Check coordinator logs for rejoin attempts If needed, re-pair devices starting with routers first High Interference Scores on All Channels \u00b6 This indicates a very busy 2.4 GHz spectrum Consider moving Wi-Fi networks to 5 GHz if possible Use the channel with the lowest score even if it's not ideal Monitor Zigbee network performance and adjust if needed Host Scan Not Working \u00b6 Verify Wi-Fi adapter is available: iwconfig or ip link Check permissions: May need to run as root or with capabilities Try both iwlist and nmcli methods Consider using manual mode as alternative Best Practices \u00b6 Run scans periodically : Wi-Fi networks change over time Scan during peak hours : Get a realistic picture of interference Consider all neighbors : Include all visible networks, not just yours Don't change channels frequently : Zigbee networks need time to stabilize Document your changes : Keep notes on channel changes and results Additional Resources \u00b6 Zigbee2MQTT: Best Practices ZHA Channel Migration Guide Understanding 2.4 GHz Spectrum Support \u00b6 If you encounter issues: 1. Check Home Assistant logs for error messages 2. Verify Wi-Fi scan data format 3. Open an issue on GitHub with: - Home Assistant version - ZigSight version - Wi-Fi scan data (redact SSIDs if needed) - Error messages from logs","title":"Wi-Fi Recommendation"},{"location":"wifi_recommendation/#wi-fi-interference-analysis-and-zigbee-channel-recommendation","text":"This guide explains how to use ZigSight's Wi-Fi interference analysis to optimize your Zigbee network by selecting the best channel.","title":"Wi-Fi Interference Analysis and Zigbee Channel Recommendation"},{"location":"wifi_recommendation/#overview","text":"Zigbee and Wi-Fi both operate in the 2.4 GHz spectrum, which can lead to interference and degraded performance. ZigSight analyzes Wi-Fi access points in your environment and recommends the optimal Zigbee channel (11, 15, 20, or 25) to minimize interference.","title":"Overview"},{"location":"wifi_recommendation/#understanding-channel-overlap","text":"","title":"Understanding Channel Overlap"},{"location":"wifi_recommendation/#wi-fi-channels","text":"Wi-Fi channels in the 2.4 GHz band use approximately 22 MHz of bandwidth each. While common channels are 1, 6, and 11, any channels from 1-13 (or 1-14 in some regions) may be in use.","title":"Wi-Fi Channels"},{"location":"wifi_recommendation/#zigbee-channels","text":"Zigbee uses much narrower channels (~2 MHz) numbered 11-26 in the 2.4 GHz band. However, only channels 11, 15, 20, and 25 are recommended because they provide optimal spacing from common Wi-Fi channels.","title":"Zigbee Channels"},{"location":"wifi_recommendation/#overlap-mapping","text":"Zigbee Channel 11 (~2405 MHz): Overlaps with Wi-Fi channels 1-2 Zigbee Channel 15 (~2425 MHz): Overlaps with Wi-Fi channels 2-4 Zigbee Channel 20 (~2450 MHz): Overlaps with Wi-Fi channels 6-8 Zigbee Channel 25 (~2475 MHz): Overlaps with Wi-Fi channels 11-13","title":"Overlap Mapping"},{"location":"wifi_recommendation/#using-the-service","text":"","title":"Using the Service"},{"location":"wifi_recommendation/#method-1-manual-upload-recommended-for-most-users","text":"This is the easiest method. Export Wi-Fi scan data from your router, then upload it to ZigSight.","title":"Method 1: Manual Upload (Recommended for Most Users)"},{"location":"wifi_recommendation/#step-1-obtain-wi-fi-scan-data","text":"See the router-specific guides below for how to export Wi-Fi scan data.","title":"Step 1: Obtain Wi-Fi Scan Data"},{"location":"wifi_recommendation/#step-2-call-the-service","text":"In Home Assistant, go to Developer Tools > Services Select service: zigsight.recommend_channel Set mode to manual Paste your Wi-Fi scan data in the wifi_scan_data field Example service call: service: zigsight.recommend_channel data: mode: manual wifi_scan_data: - channel: 1 rssi: -45 ssid: \"MyNetwork\" - channel: 6 rssi: -60 ssid: \"NeighborNetwork\" - channel: 11 rssi: -75 ssid: \"AnotherNetwork\" The service will log the recommendation and explanation to Home Assistant logs. You can also retrieve the last recommendation from hass.data[DOMAIN][\"last_recommendation\"] .","title":"Step 2: Call the Service"},{"location":"wifi_recommendation/#method-2-router-api-mode","text":"This mode directly queries your router's API for Wi-Fi scan data (when implemented for your router). Note: Router API support is currently a placeholder and requires router-specific implementation. For now, use manual mode. Example (future functionality): service: zigsight.recommend_channel data: mode: router_api router_type: unifi host: 192.168.1.1 username: admin password: your_password","title":"Method 2: Router API Mode"},{"location":"wifi_recommendation/#method-3-host-scan-mode","text":"This mode runs a Wi-Fi scan directly on your Home Assistant host using system tools (iwlist or nmcli). Requirements: - Home Assistant running on hardware with a Wi-Fi adapter - Appropriate permissions to run scanning commands - May require a privileged add-on configuration Example: service: zigsight.recommend_channel data: mode: host_scan interface: wlan0 # Optional, defaults to wlan0 Note: This mode may not work in Docker containers or supervised installations without additional configuration.","title":"Method 3: Host Scan Mode"},{"location":"wifi_recommendation/#router-specific-guides","text":"","title":"Router-Specific Guides"},{"location":"wifi_recommendation/#unifi","text":"Log in to your UniFi controller Navigate to Insights > Wi-Fi View the RF Environment scan Export or note down: Channel numbers RSSI values (signal strength) SSIDs Format for ZigSight: [ {\"channel\": 1, \"rssi\": -45, \"ssid\": \"Network1\"}, {\"channel\": 6, \"rssi\": -60, \"ssid\": \"Network2\"} ]","title":"UniFi"},{"location":"wifi_recommendation/#openwrt","text":"SSH into your OpenWrt router Run: iwinfo wlan0 scan Note the Channel and Signal values Format as JSON for ZigSight","title":"OpenWrt"},{"location":"wifi_recommendation/#fritzbox","text":"Log in to Fritz!Box web interface Navigate to WLAN > Radio Channel View the channel usage graph Note which channels have active networks Estimate RSSI based on signal strength indicators","title":"Fritz!Box"},{"location":"wifi_recommendation/#generic-router","text":"Most routers have a Wi-Fi analyzer or channel scanner: 1. Look for \"Wi-Fi Analyzer\", \"Channel Scanner\", or \"RF Environment\" in your router settings 2. Export or screenshot the scan results 3. Create a JSON list with channel and approximate RSSI values RSSI Guidelines: - Excellent signal: -30 to -50 dBm - Good signal: -50 to -65 dBm - Fair signal: -65 to -80 dBm - Weak signal: -80 to -90 dBm","title":"Generic Router"},{"location":"wifi_recommendation/#understanding-results","text":"The service returns: - recommended_channel : The best Zigbee channel (11, 15, 20, or 25) - scores : Interference scores for all 4 channels (0 = best, 100 = worst) - explanation : Human-readable summary of the analysis Example result logged: INFO: Zigbee channel recommendation: Channel 15 (score: 12.3) INFO: Recommendation: Analyzed 8 Wi-Fi access points on channels: Ch1 (3 APs), Ch6 (2 APs), Ch11 (3 APs). Zigbee channel 15 has the lowest interference score (12.3/100). This channel has minimal Wi-Fi interference.","title":"Understanding Results"},{"location":"wifi_recommendation/#changing-your-zigbee-channel","text":"\u26a0\ufe0f IMPORTANT: Changing your Zigbee channel requires careful planning","title":"Changing Your Zigbee Channel"},{"location":"wifi_recommendation/#before-you-change","text":"Backup your Zigbee network configuration through your coordinator software (Zigbee2MQTT, ZHA, or deCONZ) Plan for downtime : All devices will temporarily disconnect Ensure all devices are powered : Battery devices should have fresh batteries Schedule the change : Pick a time when automation disruption is acceptable","title":"Before You Change"},{"location":"wifi_recommendation/#migration-checklist","text":"[ ] Run Wi-Fi scan and get channel recommendation [ ] Backup Zigbee coordinator configuration [ ] Verify all devices are online and responsive [ ] Schedule migration during low-activity period [ ] Change coordinator channel in your Zigbee software [ ] Restart coordinator [ ] Wait 10-15 minutes for devices to rejoin [ ] Verify all devices are back online [ ] Test automations","title":"Migration Checklist"},{"location":"wifi_recommendation/#zigbee2mqtt","text":"Stop Zigbee2MQTT Edit configuration.yaml : yaml advanced: channel: 15 # Your recommended channel Start Zigbee2MQTT Devices will automatically rejoin (may take 10-15 minutes)","title":"Zigbee2MQTT"},{"location":"wifi_recommendation/#zha-home-assistant","text":"Go to Settings > Devices & Services > Zigbee Home Automation Click Configure Select Change channel Enter your recommended channel Confirm and wait for migration to complete","title":"ZHA (Home Assistant)"},{"location":"wifi_recommendation/#deconz","text":"Open deCONZ GUI Go to Settings > Gateway Change the channel number Restart deCONZ Devices will rejoin automatically","title":"deCONZ"},{"location":"wifi_recommendation/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"wifi_recommendation/#no-recommendation-available","text":"Ensure Wi-Fi scan data is properly formatted Check Home Assistant logs for error messages Verify JSON syntax if using manual mode","title":"No Recommendation Available"},{"location":"wifi_recommendation/#devices-not-rejoining-after-channel-change","text":"Wait at least 15-20 minutes for battery devices Power cycle mains-powered devices (routers help extend the network) Check coordinator logs for rejoin attempts If needed, re-pair devices starting with routers first","title":"Devices Not Rejoining After Channel Change"},{"location":"wifi_recommendation/#high-interference-scores-on-all-channels","text":"This indicates a very busy 2.4 GHz spectrum Consider moving Wi-Fi networks to 5 GHz if possible Use the channel with the lowest score even if it's not ideal Monitor Zigbee network performance and adjust if needed","title":"High Interference Scores on All Channels"},{"location":"wifi_recommendation/#host-scan-not-working","text":"Verify Wi-Fi adapter is available: iwconfig or ip link Check permissions: May need to run as root or with capabilities Try both iwlist and nmcli methods Consider using manual mode as alternative","title":"Host Scan Not Working"},{"location":"wifi_recommendation/#best-practices","text":"Run scans periodically : Wi-Fi networks change over time Scan during peak hours : Get a realistic picture of interference Consider all neighbors : Include all visible networks, not just yours Don't change channels frequently : Zigbee networks need time to stabilize Document your changes : Keep notes on channel changes and results","title":"Best Practices"},{"location":"wifi_recommendation/#additional-resources","text":"Zigbee2MQTT: Best Practices ZHA Channel Migration Guide Understanding 2.4 GHz Spectrum","title":"Additional Resources"},{"location":"wifi_recommendation/#support","text":"If you encounter issues: 1. Check Home Assistant logs for error messages 2. Verify Wi-Fi scan data format 3. Open an issue on GitHub with: - Home Assistant version - ZigSight version - Wi-Fi scan data (redact SSIDs if needed) - Error messages from logs","title":"Support"},{"location":"integrations/deconz/","text":"deCONZ Integration \u00b6 Coming Soon : deCONZ support is planned for a future release. Currently, ZigSight supports Zigbee2MQTT and ZHA integrations. Overview \u00b6 deCONZ is Dresden Elektronik's software for their ConBee and RaspBee Zigbee gateways. Future versions of ZigSight will integrate with deCONZ to collect device data and compute analytics. Current Status \u00b6 deCONZ integration is not yet available in ZigSight. If you're using deCONZ, you can: Use Zigbee2MQTT instead : Many users migrate from deCONZ to Zigbee2MQTT for better features and compatibility Wait for deCONZ support : Follow the GitHub repository for updates on deCONZ support Planned Features \u00b6 When deCONZ support is added, it will include: Automatic device discovery from deCONZ Device health monitoring and analytics Wi-Fi channel recommendations Network topology visualization Integration with Home Assistant's deCONZ integration Configuration (Planned) \u00b6 Step 1: Obtain API Key \u00b6 If you don't have an API key: Open the Phoscon web interface (usually http://your-ip:8080/pwa ) Go to Settings > Gateway > Advanced Click Authenticate app In the Phoscon App, go to Settings > API key and note the key Alternatively, generate via API: # Unlock gateway first (press button in Phoscon or call unlock endpoint) curl -X POST http://your-ip:8080/api -d '{\"devicetype\":\"zigsight\"}' Step 2: Add ZigSight Integration \u00b6 Go to Settings > Devices & Services Click Add Integration Search for \"ZigSight\" Select deCONZ as the integration type Step 3: Configure deCONZ Connection \u00b6 Enter the following details: Field Description Example Host deCONZ hostname or IP 192.168.1.100 or core-deconz Port deCONZ API port 8080 (default) API Key Your deCONZ API key ABCDEF1234567890 Step 4: Configure Analytics (Optional) \u00b6 Customize the analytics thresholds: Setting Description Default Battery Drain Threshold Minimum drain rate (%/hour) to trigger warning 10.0 Reconnect Rate Threshold Maximum reconnect rate (events/hour) before warning 5.0 Reconnect Rate Window Time window in hours for calculations 24 How It Works \u00b6 Device Discovery \u00b6 ZigSight queries the deCONZ REST API for device information: GET /api/{api_key}/lights GET /api/{api_key}/sensors GET /api/{api_key}/config It also connects to the websocket for real-time updates: ws://host:port/ws Data Collected \u00b6 For each device, ZigSight collects: Device Name : Name from deCONZ Device Type : Based on device classification Unique ID : MAC address/unique identifier Link Quality (LQI) : Signal strength when available Battery Level : Current battery percentage Last Seen : Timestamp of last update Manufacturer : Device manufacturer Model ID : Device model identifier Reachable : Current reachability status API Endpoints Used \u00b6 Endpoint Purpose /api/{key}/config Gateway configuration and network info /api/{key}/lights Light devices and their states /api/{key}/sensors Sensor devices and their states /api/{key}/groups Group information Websocket Real-time state updates Entities Created \u00b6 ZigSight creates sensors for each Zigbee device: Sensors \u00b6 sensor.{device}_health_score - Overall health (0-100) sensor.{device}_reconnect_rate - Reconnection frequency (events/hour) sensor.{device}_battery_trend - Battery drain rate (%/hour) Binary Sensors \u00b6 binary_sensor.{device}_connectivity_warning - Connectivity issue alert binary_sensor.{device}_battery_drain_warning - Battery drain alert Channel Recommendation \u00b6 deCONZ allows channel changes through its interface. To optimize your channel: Run the ZigSight Wi-Fi scan service to get a recommendation Open the deCONZ GUI application Go to Settings > Gateway Change the channel to the recommended value Restart deCONZ and wait for devices to rejoin See Wi-Fi Recommendation for detailed instructions. Troubleshooting \u00b6 Connection Errors \u00b6 Cannot connect to deCONZ at host:port Solutions: Verify deCONZ is running Check host and port configuration Ensure the API key is valid Check firewall settings API Key Invalid \u00b6 Unauthorized: Invalid API key Solutions: Regenerate the API key in Phoscon Ensure the gateway was unlocked when creating the key Check for extra spaces in the key Devices Not Appearing \u00b6 Check deCONZ interface : Verify devices are visible in Phoscon Verify API access : Test the API endpoint directly Check device types : ZigSight processes lights and sensors Review logs : Enable debug logging for details Missing Link Quality \u00b6 Not all devices report LQI. This is normal for: The gateway itself Some older devices Devices that use simplified reporting Websocket Disconnections \u00b6 If real-time updates aren't working: Check if port 443 is blocked (websocket port) Verify network connectivity Restart the ZigSight integration Check deCONZ logs for websocket errors Best Practices \u00b6 API Key Security \u00b6 Use a dedicated API key for ZigSight Don't share API keys between applications Regenerate if you suspect compromise deCONZ Maintenance \u00b6 Keep deCONZ firmware updated Backup your deCONZ configuration regularly Monitor the deCONZ logs for issues Network Optimization \u00b6 Position the ConBee/RaspBee centrally Add routers (mains-powered devices) for coverage Use the Wi-Fi recommendation service to avoid interference deCONZ-Specific Features \u00b6 Network Map \u00b6 deCONZ provides a network map in the desktop application: Open deCONZ GUI (not Phoscon) Select View > Network See device connections and routes This complements ZigSight's topology card. Device Firmware Updates \u00b6 Some devices support OTA updates through deCONZ: Open Phoscon web interface Go to device settings Check for available firmware updates Updated firmware can improve device reliability. Using with Home Assistant Add-on \u00b6 If running deCONZ as a Home Assistant add-on: Host: core-deconz Port: 40850 (usually) Websocket port: 8443 Check the add-on configuration for exact ports. Related Documentation \u00b6 deCONZ Official Documentation Phoscon App Documentation ZigSight Analytics ZigSight Wi-Fi Recommendation ZigSight Automations","title":"deCONZ"},{"location":"integrations/deconz/#deconz-integration","text":"Coming Soon : deCONZ support is planned for a future release. Currently, ZigSight supports Zigbee2MQTT and ZHA integrations.","title":"deCONZ Integration"},{"location":"integrations/deconz/#overview","text":"deCONZ is Dresden Elektronik's software for their ConBee and RaspBee Zigbee gateways. Future versions of ZigSight will integrate with deCONZ to collect device data and compute analytics.","title":"Overview"},{"location":"integrations/deconz/#current-status","text":"deCONZ integration is not yet available in ZigSight. If you're using deCONZ, you can: Use Zigbee2MQTT instead : Many users migrate from deCONZ to Zigbee2MQTT for better features and compatibility Wait for deCONZ support : Follow the GitHub repository for updates on deCONZ support","title":"Current Status"},{"location":"integrations/deconz/#planned-features","text":"When deCONZ support is added, it will include: Automatic device discovery from deCONZ Device health monitoring and analytics Wi-Fi channel recommendations Network topology visualization Integration with Home Assistant's deCONZ integration","title":"Planned Features"},{"location":"integrations/deconz/#configuration-planned","text":"","title":"Configuration (Planned)"},{"location":"integrations/deconz/#step-1-obtain-api-key","text":"If you don't have an API key: Open the Phoscon web interface (usually http://your-ip:8080/pwa ) Go to Settings > Gateway > Advanced Click Authenticate app In the Phoscon App, go to Settings > API key and note the key Alternatively, generate via API: # Unlock gateway first (press button in Phoscon or call unlock endpoint) curl -X POST http://your-ip:8080/api -d '{\"devicetype\":\"zigsight\"}'","title":"Step 1: Obtain API Key"},{"location":"integrations/deconz/#step-2-add-zigsight-integration","text":"Go to Settings > Devices & Services Click Add Integration Search for \"ZigSight\" Select deCONZ as the integration type","title":"Step 2: Add ZigSight Integration"},{"location":"integrations/deconz/#step-3-configure-deconz-connection","text":"Enter the following details: Field Description Example Host deCONZ hostname or IP 192.168.1.100 or core-deconz Port deCONZ API port 8080 (default) API Key Your deCONZ API key ABCDEF1234567890","title":"Step 3: Configure deCONZ Connection"},{"location":"integrations/deconz/#step-4-configure-analytics-optional","text":"Customize the analytics thresholds: Setting Description Default Battery Drain Threshold Minimum drain rate (%/hour) to trigger warning 10.0 Reconnect Rate Threshold Maximum reconnect rate (events/hour) before warning 5.0 Reconnect Rate Window Time window in hours for calculations 24","title":"Step 4: Configure Analytics (Optional)"},{"location":"integrations/deconz/#how-it-works","text":"","title":"How It Works"},{"location":"integrations/deconz/#device-discovery","text":"ZigSight queries the deCONZ REST API for device information: GET /api/{api_key}/lights GET /api/{api_key}/sensors GET /api/{api_key}/config It also connects to the websocket for real-time updates: ws://host:port/ws","title":"Device Discovery"},{"location":"integrations/deconz/#data-collected","text":"For each device, ZigSight collects: Device Name : Name from deCONZ Device Type : Based on device classification Unique ID : MAC address/unique identifier Link Quality (LQI) : Signal strength when available Battery Level : Current battery percentage Last Seen : Timestamp of last update Manufacturer : Device manufacturer Model ID : Device model identifier Reachable : Current reachability status","title":"Data Collected"},{"location":"integrations/deconz/#api-endpoints-used","text":"Endpoint Purpose /api/{key}/config Gateway configuration and network info /api/{key}/lights Light devices and their states /api/{key}/sensors Sensor devices and their states /api/{key}/groups Group information Websocket Real-time state updates","title":"API Endpoints Used"},{"location":"integrations/deconz/#entities-created","text":"ZigSight creates sensors for each Zigbee device:","title":"Entities Created"},{"location":"integrations/deconz/#sensors","text":"sensor.{device}_health_score - Overall health (0-100) sensor.{device}_reconnect_rate - Reconnection frequency (events/hour) sensor.{device}_battery_trend - Battery drain rate (%/hour)","title":"Sensors"},{"location":"integrations/deconz/#binary-sensors","text":"binary_sensor.{device}_connectivity_warning - Connectivity issue alert binary_sensor.{device}_battery_drain_warning - Battery drain alert","title":"Binary Sensors"},{"location":"integrations/deconz/#channel-recommendation","text":"deCONZ allows channel changes through its interface. To optimize your channel: Run the ZigSight Wi-Fi scan service to get a recommendation Open the deCONZ GUI application Go to Settings > Gateway Change the channel to the recommended value Restart deCONZ and wait for devices to rejoin See Wi-Fi Recommendation for detailed instructions.","title":"Channel Recommendation"},{"location":"integrations/deconz/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"integrations/deconz/#connection-errors","text":"Cannot connect to deCONZ at host:port Solutions: Verify deCONZ is running Check host and port configuration Ensure the API key is valid Check firewall settings","title":"Connection Errors"},{"location":"integrations/deconz/#api-key-invalid","text":"Unauthorized: Invalid API key Solutions: Regenerate the API key in Phoscon Ensure the gateway was unlocked when creating the key Check for extra spaces in the key","title":"API Key Invalid"},{"location":"integrations/deconz/#devices-not-appearing","text":"Check deCONZ interface : Verify devices are visible in Phoscon Verify API access : Test the API endpoint directly Check device types : ZigSight processes lights and sensors Review logs : Enable debug logging for details","title":"Devices Not Appearing"},{"location":"integrations/deconz/#missing-link-quality","text":"Not all devices report LQI. This is normal for: The gateway itself Some older devices Devices that use simplified reporting","title":"Missing Link Quality"},{"location":"integrations/deconz/#websocket-disconnections","text":"If real-time updates aren't working: Check if port 443 is blocked (websocket port) Verify network connectivity Restart the ZigSight integration Check deCONZ logs for websocket errors","title":"Websocket Disconnections"},{"location":"integrations/deconz/#best-practices","text":"","title":"Best Practices"},{"location":"integrations/deconz/#api-key-security","text":"Use a dedicated API key for ZigSight Don't share API keys between applications Regenerate if you suspect compromise","title":"API Key Security"},{"location":"integrations/deconz/#deconz-maintenance","text":"Keep deCONZ firmware updated Backup your deCONZ configuration regularly Monitor the deCONZ logs for issues","title":"deCONZ Maintenance"},{"location":"integrations/deconz/#network-optimization","text":"Position the ConBee/RaspBee centrally Add routers (mains-powered devices) for coverage Use the Wi-Fi recommendation service to avoid interference","title":"Network Optimization"},{"location":"integrations/deconz/#deconz-specific-features","text":"","title":"deCONZ-Specific Features"},{"location":"integrations/deconz/#network-map","text":"deCONZ provides a network map in the desktop application: Open deCONZ GUI (not Phoscon) Select View > Network See device connections and routes This complements ZigSight's topology card.","title":"Network Map"},{"location":"integrations/deconz/#device-firmware-updates","text":"Some devices support OTA updates through deCONZ: Open Phoscon web interface Go to device settings Check for available firmware updates Updated firmware can improve device reliability.","title":"Device Firmware Updates"},{"location":"integrations/deconz/#using-with-home-assistant-add-on","text":"If running deCONZ as a Home Assistant add-on: Host: core-deconz Port: 40850 (usually) Websocket port: 8443 Check the add-on configuration for exact ports.","title":"Using with Home Assistant Add-on"},{"location":"integrations/deconz/#related-documentation","text":"deCONZ Official Documentation Phoscon App Documentation ZigSight Analytics ZigSight Wi-Fi Recommendation ZigSight Automations","title":"Related Documentation"},{"location":"integrations/zha/","text":"ZHA Integration \u00b6 This guide explains how to configure ZigSight with Zigbee Home Automation (ZHA). Overview \u00b6 ZHA is Home Assistant's native Zigbee integration. It provides direct communication with Zigbee devices without requiring external bridges. ZigSight integrates with ZHA to provide enhanced analytics and monitoring capabilities. Prerequisites \u00b6 Before configuring ZigSight with ZHA, ensure you have: ZHA integration configured and running in Home Assistant Zigbee coordinator connected (e.g., Sonoff Zigbee 3.0 USB, ConBee II, CC2652) Devices paired with your ZHA network Home Assistant 2025.10.0 or later Configuration \u00b6 Step 1: Add ZigSight Integration \u00b6 Go to Settings > Devices & Services Click Add Integration Search for \"ZigSight\" Select ZHA as the integration type Step 2: Configure Analytics (Optional) \u00b6 Customize the analytics thresholds: Setting Description Default Battery Drain Threshold Minimum drain rate (%/hour) to trigger warning 10.0 Reconnect Rate Threshold Maximum reconnect rate (events/hour) before warning 5.0 Reconnect Rate Window Time window in hours for calculations 24 Reconnect Threshold Number of reconnections to track 5 Data Retention Number of days to keep device history 30 How It Works \u00b6 Device Discovery \u00b6 ZigSight uses the ZHA device registry to discover devices. It accesses: Device entities from Home Assistant ZHA device attributes Device state changes via events Data Collected \u00b6 For each device, ZigSight collects: Device Name : Friendly name from ZHA Device Type : Coordinator, Router, or EndDevice IEEE Address : Unique 64-bit device identifier Link Quality (LQI) : Signal strength (0-255) when available Battery Level : Current battery percentage Last Seen : Timestamp of last communication Manufacturer : Device manufacturer name Model : Device model identifier ZHA Events \u00b6 ZigSight listens to ZHA events for real-time updates: Event Usage zha_event Device interactions and updates device_registry_updated New/removed devices state_changed Entity state updates Entities Created \u00b6 ZigSight creates sensors for each Zigbee device: Sensors \u00b6 sensor.{device}_health_score - Overall health (0-100) sensor.{device}_reconnect_rate - Reconnection frequency (events/hour) sensor.{device}_battery_trend - Battery drain rate (%/hour) Binary Sensors \u00b6 binary_sensor.{device}_connectivity_warning - Connectivity issue alert binary_sensor.{device}_battery_drain_warning - Battery drain alert Channel Recommendation \u00b6 ZHA supports channel changes directly in Home Assistant. To optimize your channel: Run the ZigSight Wi-Fi scan service Get the recommended channel In Home Assistant, go to Settings > Devices & Services > ZHA Click Configure > Change channel Enter the recommended channel See Wi-Fi Recommendation for detailed instructions. Troubleshooting \u00b6 Devices Not Appearing \u00b6 Verify ZHA is running : Check the ZHA integration status Check device pairing : Ensure devices are paired in ZHA Restart integration : Try removing and re-adding ZigSight Review logs : Enable debug logging for custom_components.zigsight Missing Device Attributes \u00b6 Some devices don't report all attributes: Battery : Some mains-powered devices don't report battery LQI : Not all devices include link quality in updates Last Seen : May not update for sleeping devices Device Shows Offline \u00b6 Check if the device is within range of a router Verify the device has battery (if applicable) Try pressing a button on the device to wake it Check ZHA logs for communication errors Health Score Seems Wrong \u00b6 The health score uses multiple factors. Check individual components: View sensor.{device}_reconnect_rate for connectivity issues Check battery level directly Review link quality in ZHA device info Best Practices \u00b6 Coordinator Placement \u00b6 Place the coordinator centrally in your home Keep it away from USB 3.0 devices (interference) Elevate it if possible for better coverage Router Distribution \u00b6 Add mains-powered devices (routers) throughout your space Routers extend the network and improve reliability Good router coverage reduces reconnection issues Regular Maintenance \u00b6 Check device health scores weekly Replace batteries in devices with drain warnings Re-interview devices that show persistent issues ZHA-Specific Features \u00b6 Device Interview \u00b6 If a device is misbehaving: Go to Settings > Devices & Services > ZHA Click on the problematic device Select Reconfigure Device to re-interview Network Visualization \u00b6 ZHA provides its own network visualization: Go to Settings > Devices & Services > ZHA Click Configure Select Visualize to see the network graph This complements ZigSight's topology card with additional route information. Related Documentation \u00b6 ZHA Official Documentation ZigSight Analytics ZigSight Wi-Fi Recommendation ZigSight Automations","title":"ZHA"},{"location":"integrations/zha/#zha-integration","text":"This guide explains how to configure ZigSight with Zigbee Home Automation (ZHA).","title":"ZHA Integration"},{"location":"integrations/zha/#overview","text":"ZHA is Home Assistant's native Zigbee integration. It provides direct communication with Zigbee devices without requiring external bridges. ZigSight integrates with ZHA to provide enhanced analytics and monitoring capabilities.","title":"Overview"},{"location":"integrations/zha/#prerequisites","text":"Before configuring ZigSight with ZHA, ensure you have: ZHA integration configured and running in Home Assistant Zigbee coordinator connected (e.g., Sonoff Zigbee 3.0 USB, ConBee II, CC2652) Devices paired with your ZHA network Home Assistant 2025.10.0 or later","title":"Prerequisites"},{"location":"integrations/zha/#configuration","text":"","title":"Configuration"},{"location":"integrations/zha/#step-1-add-zigsight-integration","text":"Go to Settings > Devices & Services Click Add Integration Search for \"ZigSight\" Select ZHA as the integration type","title":"Step 1: Add ZigSight Integration"},{"location":"integrations/zha/#step-2-configure-analytics-optional","text":"Customize the analytics thresholds: Setting Description Default Battery Drain Threshold Minimum drain rate (%/hour) to trigger warning 10.0 Reconnect Rate Threshold Maximum reconnect rate (events/hour) before warning 5.0 Reconnect Rate Window Time window in hours for calculations 24 Reconnect Threshold Number of reconnections to track 5 Data Retention Number of days to keep device history 30","title":"Step 2: Configure Analytics (Optional)"},{"location":"integrations/zha/#how-it-works","text":"","title":"How It Works"},{"location":"integrations/zha/#device-discovery","text":"ZigSight uses the ZHA device registry to discover devices. It accesses: Device entities from Home Assistant ZHA device attributes Device state changes via events","title":"Device Discovery"},{"location":"integrations/zha/#data-collected","text":"For each device, ZigSight collects: Device Name : Friendly name from ZHA Device Type : Coordinator, Router, or EndDevice IEEE Address : Unique 64-bit device identifier Link Quality (LQI) : Signal strength (0-255) when available Battery Level : Current battery percentage Last Seen : Timestamp of last communication Manufacturer : Device manufacturer name Model : Device model identifier","title":"Data Collected"},{"location":"integrations/zha/#zha-events","text":"ZigSight listens to ZHA events for real-time updates: Event Usage zha_event Device interactions and updates device_registry_updated New/removed devices state_changed Entity state updates","title":"ZHA Events"},{"location":"integrations/zha/#entities-created","text":"ZigSight creates sensors for each Zigbee device:","title":"Entities Created"},{"location":"integrations/zha/#sensors","text":"sensor.{device}_health_score - Overall health (0-100) sensor.{device}_reconnect_rate - Reconnection frequency (events/hour) sensor.{device}_battery_trend - Battery drain rate (%/hour)","title":"Sensors"},{"location":"integrations/zha/#binary-sensors","text":"binary_sensor.{device}_connectivity_warning - Connectivity issue alert binary_sensor.{device}_battery_drain_warning - Battery drain alert","title":"Binary Sensors"},{"location":"integrations/zha/#channel-recommendation","text":"ZHA supports channel changes directly in Home Assistant. To optimize your channel: Run the ZigSight Wi-Fi scan service Get the recommended channel In Home Assistant, go to Settings > Devices & Services > ZHA Click Configure > Change channel Enter the recommended channel See Wi-Fi Recommendation for detailed instructions.","title":"Channel Recommendation"},{"location":"integrations/zha/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"integrations/zha/#devices-not-appearing","text":"Verify ZHA is running : Check the ZHA integration status Check device pairing : Ensure devices are paired in ZHA Restart integration : Try removing and re-adding ZigSight Review logs : Enable debug logging for custom_components.zigsight","title":"Devices Not Appearing"},{"location":"integrations/zha/#missing-device-attributes","text":"Some devices don't report all attributes: Battery : Some mains-powered devices don't report battery LQI : Not all devices include link quality in updates Last Seen : May not update for sleeping devices","title":"Missing Device Attributes"},{"location":"integrations/zha/#device-shows-offline","text":"Check if the device is within range of a router Verify the device has battery (if applicable) Try pressing a button on the device to wake it Check ZHA logs for communication errors","title":"Device Shows Offline"},{"location":"integrations/zha/#health-score-seems-wrong","text":"The health score uses multiple factors. Check individual components: View sensor.{device}_reconnect_rate for connectivity issues Check battery level directly Review link quality in ZHA device info","title":"Health Score Seems Wrong"},{"location":"integrations/zha/#best-practices","text":"","title":"Best Practices"},{"location":"integrations/zha/#coordinator-placement","text":"Place the coordinator centrally in your home Keep it away from USB 3.0 devices (interference) Elevate it if possible for better coverage","title":"Coordinator Placement"},{"location":"integrations/zha/#router-distribution","text":"Add mains-powered devices (routers) throughout your space Routers extend the network and improve reliability Good router coverage reduces reconnection issues","title":"Router Distribution"},{"location":"integrations/zha/#regular-maintenance","text":"Check device health scores weekly Replace batteries in devices with drain warnings Re-interview devices that show persistent issues","title":"Regular Maintenance"},{"location":"integrations/zha/#zha-specific-features","text":"","title":"ZHA-Specific Features"},{"location":"integrations/zha/#device-interview","text":"If a device is misbehaving: Go to Settings > Devices & Services > ZHA Click on the problematic device Select Reconfigure Device to re-interview","title":"Device Interview"},{"location":"integrations/zha/#network-visualization","text":"ZHA provides its own network visualization: Go to Settings > Devices & Services > ZHA Click Configure Select Visualize to see the network graph This complements ZigSight's topology card with additional route information.","title":"Network Visualization"},{"location":"integrations/zha/#related-documentation","text":"ZHA Official Documentation ZigSight Analytics ZigSight Wi-Fi Recommendation ZigSight Automations","title":"Related Documentation"},{"location":"integrations/zigbee2mqtt/","text":"Zigbee2MQTT Integration \u00b6 This guide explains how to configure ZigSight with Zigbee2MQTT. Overview \u00b6 Zigbee2MQTT is a popular open-source Zigbee bridge that uses MQTT for communication. ZigSight integrates with Zigbee2MQTT to collect device data, compute analytics, and provide network visualization. Prerequisites \u00b6 Before configuring ZigSight with Zigbee2MQTT, ensure you have: Zigbee2MQTT installed and running MQTT broker (Mosquitto or similar) configured Home Assistant with MQTT integration enabled Devices paired with your Zigbee2MQTT instance Configuration \u00b6 Step 1: Add ZigSight Integration \u00b6 Go to Settings > Devices & Services Click Add Integration Search for \"ZigSight\" Select Zigbee2MQTT as the integration type Step 2: Configure MQTT Connection \u00b6 Enter the following details: Field Description Example MQTT Broker MQTT broker hostname or IP. Leave as localhost to use Home Assistant's MQTT integration localhost or 192.168.1.100 or core-mosquitto MQTT Port MQTT broker port 1883 MQTT Username MQTT username (optional, if broker requires authentication) homeassistant MQTT Password MQTT password (optional, if broker requires authentication) your_password MQTT Topic Prefix Zigbee2MQTT base topic prefix zigbee2mqtt Note : If you're using Home Assistant's built-in MQTT integration, leave the MQTT Broker as localhost . ZigSight will automatically use Home Assistant's MQTT connection. Only specify a different broker if you're using a separate MQTT instance. Step 3: Configure Analytics (Optional) \u00b6 Customize the analytics thresholds: Setting Description Default Battery Drain Threshold Minimum drain rate (%/hour) to trigger warning 10.0 Reconnect Rate Threshold Maximum reconnect rate (events/hour) before warning 5.0 Reconnect Rate Window Time window in hours for calculations 24 How It Works \u00b6 Device Discovery \u00b6 ZigSight subscribes to Zigbee2MQTT MQTT topics to discover devices: zigbee2mqtt/bridge/devices # Device list zigbee2mqtt/+ # Device state updates zigbee2mqtt/bridge/state # Bridge status When Zigbee2MQTT publishes device updates, ZigSight processes the data and updates metrics. Data Collected \u00b6 For each device, ZigSight collects: Device Name : Friendly name from Zigbee2MQTT Device Type : Coordinator, Router, or EndDevice IEEE Address : Unique device identifier Link Quality (LQI) : Signal strength (0-255) Battery Level : Current battery percentage Last Seen : Timestamp of last communication Network Address : Short network address MQTT Topics \u00b6 ZigSight listens to these topics: Topic Data {topic_prefix}/bridge/devices Full device list with details {topic_prefix}/bridge/state Bridge online/offline status {topic_prefix}/{friendly_name} Device state updates {topic_prefix}/bridge/event Join/leave events Where {topic_prefix} is the MQTT Topic Prefix you configured (default: zigbee2mqtt ). Entities Created \u00b6 ZigSight creates sensors for each Zigbee device: Sensors \u00b6 sensor.{device}_health_score - Overall health (0-100) sensor.{device}_reconnect_rate - Reconnection frequency (events/hour) sensor.{device}_battery_trend - Battery drain rate (%/hour) Binary Sensors \u00b6 binary_sensor.{device}_connectivity_warning - Connectivity issue alert binary_sensor.{device}_battery_drain_warning - Battery drain alert Example Configuration \u00b6 Here's a complete configuration example: # In Home Assistant, configure via UI: # Settings > Devices & Services > Add Integration > ZigSight # For reference, the configuration includes: # - Integration Type: Zigbee2MQTT # - MQTT Host: core-mosquitto (for Home Assistant Add-on) # - MQTT Port: 1883 # - Base Topic: zigbee2mqtt # - Battery Drain Threshold: 10.0 # - Reconnect Rate Threshold: 5.0 Troubleshooting \u00b6 Devices Not Appearing \u00b6 Check MQTT connection : Verify ZigSight can connect to your MQTT broker If using Home Assistant's MQTT integration, ensure it's configured and running If using a separate broker, verify the host, port, and credentials are correct Verify topic prefix : Ensure the MQTT Topic Prefix matches your Zigbee2MQTT configuration (usually zigbee2mqtt ) Check device list : Verify Zigbee2MQTT is publishing to {topic_prefix}/bridge/devices Review logs : Enable debug logging for custom_components.zigsight Incorrect Device Data \u00b6 Verify Zigbee2MQTT version : Use a recent version for best compatibility Check device reporting : Some devices don't report all attributes Wait for updates : Metrics require time to accumulate data MQTT Connection Errors \u00b6 Error connecting to MQTT broker Solutions: Verify MQTT broker is running Check host/port configuration Verify username/password if authentication is required Check firewall settings Missing Link Quality \u00b6 Not all devices report link quality (LQI). This is normal for: The coordinator itself Some older or basic devices Best Practices \u00b6 MQTT Broker Configuration \u00b6 For best results: Use a dedicated MQTT user for ZigSight Enable persistent sessions if using QoS > 0 Keep the MQTT broker on the same network as Home Assistant Topic Organization \u00b6 If you have multiple Zigbee2MQTT instances: Use distinct topic prefixes (e.g., zigbee2mqtt/home , zigbee2mqtt/garage ) Configure each Zigbee2MQTT instance with a different topic prefix Note: ZigSight currently supports one instance per Home Assistant installation Monitoring \u00b6 Review device health scores weekly Set up automation blueprints for alerts Use the topology card for network visualization Related Documentation \u00b6 Zigbee2MQTT Official Documentation ZigSight Analytics ZigSight Automations","title":"Zigbee2MQTT"},{"location":"integrations/zigbee2mqtt/#zigbee2mqtt-integration","text":"This guide explains how to configure ZigSight with Zigbee2MQTT.","title":"Zigbee2MQTT Integration"},{"location":"integrations/zigbee2mqtt/#overview","text":"Zigbee2MQTT is a popular open-source Zigbee bridge that uses MQTT for communication. ZigSight integrates with Zigbee2MQTT to collect device data, compute analytics, and provide network visualization.","title":"Overview"},{"location":"integrations/zigbee2mqtt/#prerequisites","text":"Before configuring ZigSight with Zigbee2MQTT, ensure you have: Zigbee2MQTT installed and running MQTT broker (Mosquitto or similar) configured Home Assistant with MQTT integration enabled Devices paired with your Zigbee2MQTT instance","title":"Prerequisites"},{"location":"integrations/zigbee2mqtt/#configuration","text":"","title":"Configuration"},{"location":"integrations/zigbee2mqtt/#step-1-add-zigsight-integration","text":"Go to Settings > Devices & Services Click Add Integration Search for \"ZigSight\" Select Zigbee2MQTT as the integration type","title":"Step 1: Add ZigSight Integration"},{"location":"integrations/zigbee2mqtt/#step-2-configure-mqtt-connection","text":"Enter the following details: Field Description Example MQTT Broker MQTT broker hostname or IP. Leave as localhost to use Home Assistant's MQTT integration localhost or 192.168.1.100 or core-mosquitto MQTT Port MQTT broker port 1883 MQTT Username MQTT username (optional, if broker requires authentication) homeassistant MQTT Password MQTT password (optional, if broker requires authentication) your_password MQTT Topic Prefix Zigbee2MQTT base topic prefix zigbee2mqtt Note : If you're using Home Assistant's built-in MQTT integration, leave the MQTT Broker as localhost . ZigSight will automatically use Home Assistant's MQTT connection. Only specify a different broker if you're using a separate MQTT instance.","title":"Step 2: Configure MQTT Connection"},{"location":"integrations/zigbee2mqtt/#step-3-configure-analytics-optional","text":"Customize the analytics thresholds: Setting Description Default Battery Drain Threshold Minimum drain rate (%/hour) to trigger warning 10.0 Reconnect Rate Threshold Maximum reconnect rate (events/hour) before warning 5.0 Reconnect Rate Window Time window in hours for calculations 24","title":"Step 3: Configure Analytics (Optional)"},{"location":"integrations/zigbee2mqtt/#how-it-works","text":"","title":"How It Works"},{"location":"integrations/zigbee2mqtt/#device-discovery","text":"ZigSight subscribes to Zigbee2MQTT MQTT topics to discover devices: zigbee2mqtt/bridge/devices # Device list zigbee2mqtt/+ # Device state updates zigbee2mqtt/bridge/state # Bridge status When Zigbee2MQTT publishes device updates, ZigSight processes the data and updates metrics.","title":"Device Discovery"},{"location":"integrations/zigbee2mqtt/#data-collected","text":"For each device, ZigSight collects: Device Name : Friendly name from Zigbee2MQTT Device Type : Coordinator, Router, or EndDevice IEEE Address : Unique device identifier Link Quality (LQI) : Signal strength (0-255) Battery Level : Current battery percentage Last Seen : Timestamp of last communication Network Address : Short network address","title":"Data Collected"},{"location":"integrations/zigbee2mqtt/#mqtt-topics","text":"ZigSight listens to these topics: Topic Data {topic_prefix}/bridge/devices Full device list with details {topic_prefix}/bridge/state Bridge online/offline status {topic_prefix}/{friendly_name} Device state updates {topic_prefix}/bridge/event Join/leave events Where {topic_prefix} is the MQTT Topic Prefix you configured (default: zigbee2mqtt ).","title":"MQTT Topics"},{"location":"integrations/zigbee2mqtt/#entities-created","text":"ZigSight creates sensors for each Zigbee device:","title":"Entities Created"},{"location":"integrations/zigbee2mqtt/#sensors","text":"sensor.{device}_health_score - Overall health (0-100) sensor.{device}_reconnect_rate - Reconnection frequency (events/hour) sensor.{device}_battery_trend - Battery drain rate (%/hour)","title":"Sensors"},{"location":"integrations/zigbee2mqtt/#binary-sensors","text":"binary_sensor.{device}_connectivity_warning - Connectivity issue alert binary_sensor.{device}_battery_drain_warning - Battery drain alert","title":"Binary Sensors"},{"location":"integrations/zigbee2mqtt/#example-configuration","text":"Here's a complete configuration example: # In Home Assistant, configure via UI: # Settings > Devices & Services > Add Integration > ZigSight # For reference, the configuration includes: # - Integration Type: Zigbee2MQTT # - MQTT Host: core-mosquitto (for Home Assistant Add-on) # - MQTT Port: 1883 # - Base Topic: zigbee2mqtt # - Battery Drain Threshold: 10.0 # - Reconnect Rate Threshold: 5.0","title":"Example Configuration"},{"location":"integrations/zigbee2mqtt/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"integrations/zigbee2mqtt/#devices-not-appearing","text":"Check MQTT connection : Verify ZigSight can connect to your MQTT broker If using Home Assistant's MQTT integration, ensure it's configured and running If using a separate broker, verify the host, port, and credentials are correct Verify topic prefix : Ensure the MQTT Topic Prefix matches your Zigbee2MQTT configuration (usually zigbee2mqtt ) Check device list : Verify Zigbee2MQTT is publishing to {topic_prefix}/bridge/devices Review logs : Enable debug logging for custom_components.zigsight","title":"Devices Not Appearing"},{"location":"integrations/zigbee2mqtt/#incorrect-device-data","text":"Verify Zigbee2MQTT version : Use a recent version for best compatibility Check device reporting : Some devices don't report all attributes Wait for updates : Metrics require time to accumulate data","title":"Incorrect Device Data"},{"location":"integrations/zigbee2mqtt/#mqtt-connection-errors","text":"Error connecting to MQTT broker Solutions: Verify MQTT broker is running Check host/port configuration Verify username/password if authentication is required Check firewall settings","title":"MQTT Connection Errors"},{"location":"integrations/zigbee2mqtt/#missing-link-quality","text":"Not all devices report link quality (LQI). This is normal for: The coordinator itself Some older or basic devices","title":"Missing Link Quality"},{"location":"integrations/zigbee2mqtt/#best-practices","text":"","title":"Best Practices"},{"location":"integrations/zigbee2mqtt/#mqtt-broker-configuration","text":"For best results: Use a dedicated MQTT user for ZigSight Enable persistent sessions if using QoS > 0 Keep the MQTT broker on the same network as Home Assistant","title":"MQTT Broker Configuration"},{"location":"integrations/zigbee2mqtt/#topic-organization","text":"If you have multiple Zigbee2MQTT instances: Use distinct topic prefixes (e.g., zigbee2mqtt/home , zigbee2mqtt/garage ) Configure each Zigbee2MQTT instance with a different topic prefix Note: ZigSight currently supports one instance per Home Assistant installation","title":"Topic Organization"},{"location":"integrations/zigbee2mqtt/#monitoring","text":"Review device health scores weekly Set up automation blueprints for alerts Use the topology card for network visualization","title":"Monitoring"},{"location":"integrations/zigbee2mqtt/#related-documentation","text":"Zigbee2MQTT Official Documentation ZigSight Analytics ZigSight Automations","title":"Related Documentation"}]}